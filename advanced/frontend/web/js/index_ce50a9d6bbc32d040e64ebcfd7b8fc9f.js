function ajaxError(t){requirejs(["web_old_tip"],function(e){e.tip({text:t||"请求错误",type:"error"})})}!function(t,e){"function"==typeof define&&define.amd?define("common/js/common/SiteSearch",e):"object"==typeof exports?module.exports=e():t.SiteSearch=e()}(this,function(){function t(t){this.opts=$.extend({box:"#siteSearch"},t),this.$searchBox=$(t.box),this.$input=this.$searchBox.find(".txt"),this.$form=this.$searchBox.find("form"),this.searchUrl=this.$form.attr("action"),this.ajaxUrls={sitesearch:"qcross/home/ajax?action=sitesearch"},this.searchTimer=null,this.$history=null,this.$autocomplete=null,this._history=[],this._search={},this.init()}return t.prototype={init:function(){this.createHistory(),this.createAutoComplete(),this.bindEvent(),this.getStorage()},bindEvent:function(){var t=this;this.$input.on("focus",function(){t.hideLayer(),t.searchBoxActive()}),this.$searchBox.on("click",function(){t.$input.trigger("focus")}),this.$input.on("keyup",function(e){switch(e.keyCode){case 38:t.switchUpDown("up");break;case 40:t.switchUpDown("down");break;default:clearTimeout(t.searchTimer),t.searchTimer=setTimeout(function(){""==t.getSearchWord()?t.showHistory():t.searchWord(t.getSearchWord())},400)}}),this.$form.on("submit",function(){var e=$.trim(t.$input.val()),i=t.searchUrl+"?wd="+window.encodeURIComponent(e);return""!=e&&void t.setStorage(e,i)})},searchBoxActive:function(){this.$searchBox.addClass("active"),this.clickDocumentEvent(this.$searchBox[0],this.searchBoxClose),""==this.getSearchWord()?this.showHistory():this.searchWord(this.getSearchWord())},searchBoxClose:function(){this.$searchBox.removeClass("active"),this.$input.val(""),this.$history&&this.$history.removeClass("show")},clickDocumentEvent:function(t,e){var i=this,s="e_"+(new Date).getTime();$(document).unbind("click."+s),$(document).bind("click."+s,function(o){HomeUtil.isParent(o.target,t)||o.target==t||(e.call(i),$(document).unbind("click."+s))})},createHistory:function(){if(!window.localStorage)return!1;var t=this,e=['<div class="q-layer q-layer-sitesearch-history">',"<ul>","</ul>",'<div class="history-clear">','<a href="javascript:;">清空历史记录</a>',"</div>","</div>"];this.$searchBox.append(e.join("")),this.$history=this.$searchBox.find(".q-layer-sitesearch-history"),this.$history.on("click",".history-clear > a",function(){t.clearStorage()})},hideLayer:function(){this.$searchBox.find(".q-layer").removeClass("show")},showHistory:function(){if(!this._history.length)return!1;for(var t=[],e=0;e<this._history.length&&(t.push('<li data-type="history" data-wd="'+this._history[e].key+'"><a href="'+this._history[e].url+'">'+this._history[e].key+"</a></li>"),!(e>=4));e++);this.$history.find("ul").html(t.join("")),this.$history.addClass("show"),this.hideAutoComplete()},hideHistory:function(){this.$history.removeClass("show")},showAutoComplete:function(){this.$autocomplete.addClass("show")},hideAutoComplete:function(){this.$autocomplete.removeClass("show")},createAutoComplete:function(){var t=['<div class="q-layer q-layer-sitesearch-autocomplete">',"<ul>","</ul>","</div>"];this.$searchBox.append(t.join("")),this.$autocomplete=this.$searchBox.find(".q-layer-sitesearch-autocomplete")},getStorage:function(){if(window.localStorage&&window.localStorage.sitesearch_history){var t=window.localStorage.sitesearch_history;this._history=JSON.parse(t)}},setStorage:function(t,e){if(!window.localStorage)return!1;for(var i=-1,s=0;s<this._history.length;s++)if(this._history[s].key==t){i=s;break}i!=-1&&this._history.splice(s,1),this._history.unshift({key:t,url:e}),window.localStorage.sitesearch_history=JSON.stringify(this._history)},getSearchWord:function(){return HomeUtil.fliterScript($.trim(this.$input.val()))},setSearchWord:function(t){this.$input.val(t)},clearStorage:function(){return!!window.localStorage&&(window.localStorage.removeItem("sitesearch_history"),this._history=[],void this.$history.find("ul").empty())},switchUpDown:function(t){this.$history.is(":visible")?this.switchUpDownInHistory(t):this.$autocomplete.is(":visible")&&this.switchUpDownInAutoComplete(t)},switchUpDownInHistory:function(t){var e=this.$history.find("li"),i=this.$history.find("li.current"),s=null;s="up"==t?i.length&&i.prev().length?i.prev():e.last():i.length&&i.next().length?i.next():e.first(),this.currentLayer(s)},switchUpDownInAutoComplete:function(t){var e=this.$autocomplete.find("li"),i=this.$autocomplete.find("li.current"),s=null;s="up"==t?i.length&&i.prev().length?i.prev():e.last():i.length&&i.next().length?i.next():e.first(),this.currentLayer(s)},currentLayer:function(t){switch(t.addClass("current").siblings().removeClass("current"),this.$form.attr("action",this.searchUrl),t.attr("data-type")){case"history":this.setSearchWord(t.attr("data-wd"));break;case"item":this.$form.attr("action",t.find("a").attr("href"));break;case"word":this.setSearchWord(t.find("a").text())}},ajaxSearch:function(t){var e=this,i={keyword:t,timer:(new Date).getTime()};$.getJSON(this.ajaxUrls.sitesearch,i,function(i){0==i.error_code?i.data.list.length?e.renderAutoComplete(e.$autocomplete,i.data,t):e.hideLayer():i.data.msg&&ajaxError(i.data.msg)})},searchWord:function(t){this._search[t]?this.renderAutoComplete(this.$autocomplete,this._search[t]):this.ajaxSearch(t)},renderAutoComplete:function(t,e,i){var s=[];if("string"==typeof e)s=e;else{for(var o=0;o<e.list.length;o++){var n=e.list[o];"item"==n.type_name?(s.push('<li data-type="item">'),s.push('<a href="'+n.url+'">'),s.push("<dl>"),s.push("<dt>"),s.push('<img src="'+n.src+'" width="30" height="30" />'),s.push("</dt>"),s.push("<dd>"),s.push("<p>"),s.push('<span class="cn">'+n.cn_name+"</span>"),s.push('<span class="en">'+n.en_name+"</span>"),s.push("</p>"),s.push("<p>"),s.push('<span class="poi">'+n.belong_name+"</span>"),s.push("</p>"),s.push("</dd>"),s.push("</dl>"),s.push("</a>"),s.push("</li>")):s.push('<li data-type="word"><a href="'+n.url+'">'+n.word+"</a></li>")}s=s.join("")}s&&(t.find("ul").html(s),this._search[i]=s),this.hideHistory(),this.showAutoComplete()},replaceKeyword:function(t,e){return t.replace(e,"<em>"+e+"</em>")}},t}),define("common/js/common/UserStatus",[],function(){function t(t){this.opts=$.extend({box:"#userStatus"},t),this.$userStatusBox=$(this.opts.box),this.ajaxUrls={userStatus:"qcross/home/ajax?action=loginstatus",msgCount:"qcross/user/ajax.php?action=getunreadcount",msgInfo:"qcross/home/ajax?action=notice"},this.newMessage=!0,this.xhrStatus=null,this.userStatusCount=1,this.init()}return t.prototype={init:function(){window.QYER=window.QYER||{uid:0},this.getUserStatus()},getUserStatus:function(){var t=this;this.xhrStatus=$.ajax({url:this.ajaxUrls.userStatus,data:{timer:+new Date},dataType:"json",timeout:3e3,success:function(e){window._qyer_userid=e.data.uid,0==e.error_code&&(e.data.uid>0&&(t.renderUserInfoInner(e.data.userinfo),window.QYER.uid=e.data.uid),t.bindEvent(),window.__userStatusCallBack&&__userStatusCallBack.call(window,e.data))},error:function(e,i,s){10===t.userStatusCount||"timeout"===i&&(t.userStatusCount+=1,t.xhrStatus.abort(),t.getUserStatus())}})},renderLoginInner:function(){var t=['<div class="login show">','<a class="otherlogin-link" href="javascript:;" rel="noflow" data-bn-ipg="index-head-un-qq" data-type="qq"><i class="iconfont icon-qq"></i></a> ','<a class="otherlogin-link" href="javascript:;" rel="noflow" data-bn-ipg="index-head-un-weibo" data-type="weibo"><i class="iconfont icon-weibo"></i></a> ','<a class="otherlogin-link" href="javascript:;" rel="noflow" data-bn-ipg="index-head-un-wechat" data-type="weixin"><i class="iconfont icon-weixin"></i></a> ','<a href="//login.qyer.com/?action=register" data-bn-ipg="index-head-un-register">注册</a> ','<a href="//login.qyer.com/?action=login" data-bn-ipg="index-head-un-login">登录</a>',"</div>"].join("");this.$userStatusBox.html(t)},renderUserInfoInner:function(t){function e(t){var e="";return e+=' <span class="auth_avatar_q s">',e+="<i"+(t.url&&""!=t.url?" onclick=\"window.location='"+t.url+"';\"":"")+' class="icon '+t.type+'" title="'+t.text+'"></i>',e+="</span>"}var i=['<div class="user-info show">','<div class="userstatus">','<span class="avatar">','<a href="//www.qyer.com/u/'+t.uid+'" data-bn-ipg="index-head-user" target="_blank"><img src="'+t.avatar+'" width="32" height="32"></a>',"</span>",' <span class="username"><a href="//www.qyer.com/u/'+t.uid+'" data-bn-ipg="index-head-user" target="_blank">'+t.username+"</a></span>",t.auth?e(t.auth):"",' <span style="vertical-align: -2px;"><i class="iconfont icon-jiantouxia"></i></span>',t.menuInner,"</div>",'<div class="usermsg">','<a class="message" href="javascript:;"><i class="iconfont icon-xinfeng"></i> <em class="num">'+(t.msgCount&&t.msgCount>0?t.msgCount:"")+"</em></a>",'<em class="newmsg"'+(t.msgCount&&t.msgCount?"":' style="display:none;"')+"></em>",'<div class="q-layer q-layer-message">','<div class="layer-msg-tab">',"<ul>",'<li class="current'+(t.msg&&t.msg.board?" new":"")+'" data-msg-type="board"><a data-bn-ipg="index-head-msgdrop-tab-black" href="javascript:;">站内通知</a></li>',"<li"+(t.msg&&t.msg.notice?' class="new"':"")+' data-msg-type="notice"><a data-bn-ipg="index-head-msgdrop-tab-notice" href="javascript:;">消息</a></li>',"<li"+(t.msg&&t.msg.message?' class="new"':"")+' data-msg-type="message"><a data-bn-ipg="index-head-msgdrop-tab-letter" href="javascript:;">私信</a></li>',"</ul>","</div>",'<div class="layer-msg-container">','<div class="layer-msg-item layer-msg-item-board" style="display: block;">','<div class="layer-msg-inner"><div class="loading"></div></div>','<div class="layer-msg-more">','<a data-bn-ipg="index-head-black-all" href="'+t.msgUrl.board+'">查看全部</a>',"</div>","</div>",'<div class="layer-msg-item layer-msg-item-notice">','<div class="layer-msg-inner"><div class="loading"></div></div>','<div class="layer-msg-more">','<a data-bn-ipg="index-head-notice-all" href="'+t.msgUrl.notice+'">查看全部</a>',"</div>","</div>",'<div class="layer-msg-item layer-msg-item-message">','<div class="layer-msg-inner"><div class="loading"></div></div>','<div class="layer-msg-more">','<a data-bn-ipg="index-head-letter-all" href="'+t.msgUrl.message+'">查看全部</a>',"</div>","</div>","</div>","</div>","</div>","</div>"].join("");this.$userStatusBox.html(i),this.getUserMsgCount()},renderUserMsgInner:function(t){this.renderMsg("board",t.board,this.$userStatusBox.find(".layer-msg-item-board > .layer-msg-inner")),this.renderMsg("notice",t.notice,this.$userStatusBox.find(".layer-msg-item-notice > .layer-msg-inner")),this.renderMsg("message",t.message,this.$userStatusBox.find(".layer-msg-item-message > .layer-msg-inner"))},renderMsg:function(t,e,i){var s,o,n=[];switch(t){case"board":s="站内通知",o="black";break;case"notice":s="消息",o="notice";break;case"message":default:s="私信",o="letter"}if(this.$userStatusBox.find("[data-msg-type="+t+"]")[e.unread>0?"addClass":"removeClass"]("new"),e.list.length){n.push("<ul>");for(var a=0;a<e.list.length;a++){var r=e.list[a];n.push("<li"+(0==r.unread?"":' class="unread"')+">"),n.push('<div class="layer-msg-cont">'),n.push('<p class="cont">'),n.push('<a href="'+r.url+'" data-bn-ipg="index-head-msgrdrop-'+o+"List-"+a+'">'+("message"==t?r.from+": ":"")+r.msg+"</a>"),n.push("</p>"),n.push("</div>"),n.push("</li>")}n.push("</ul>")}else n.push('<div class="msg-empty">暂时没有新的'+s+"</div>");i.html(n.join(""))},getUserMsgCount:function(){var t=this,e=!0,i=0;$(window).focus(function(){e=!0}).blur(function(){e=!1});var s=function(){var s=!!i,o=10*Math.random()<7,n=!e;s||o||n||(t.hasNewMessage=!0,$.getJSON(t.ajaxUrls.msgCount,{timer:(new Date).getTime()}).done(function(e){i=e.total_count,t.$userStatusBox.find(".newmsg")[e.total_count>0?"show":"hide"](),t.$userStatusBox.find(".num").html(e.total_count)}))};setInterval(function(){s()},3e4)},getUserMsgInfo:function(){var t=this;this.newMessage=!1,$.getJSON(this.ajaxUrls.msgInfo,{timer:(new Date).getTime()}).done(function(e){0==e.error_code&&t.renderUserMsgInner(e.data)})},bindEvent:function(){var t=this;this.$userStatusBox.on("click",".otherlogin-link",function(){return HomeUtil.otherlogin(this.getAttribute("data-type")),!1}).on("mouseenter",".userstatus,.usermsg",function(){clearTimeout(this.timer),$(this).addClass("hover"),$(this).hasClass("usermsg")&&t.newMessage&&t.getUserMsgInfo()}).on("mouseleave",".userstatus,.usermsg",function(){var t=$(this);this.timer=setTimeout(function(){t.removeClass("hover")},500)}).on("click",".layer-msg-tab li",function(){if($(this).hasClass("current"))return!1;var e=this.getAttribute("data-msg-type");$(this).addClass("current").siblings().removeClass("current"),t.$userStatusBox.find(".layer-msg-item-"+e).show().siblings().hide()})},otherlogin:function(t,e){var e="//login.qyer.com/auth.php?action="+t+"&popup=1&refer="+(e||window.location.href);window.location=e,e=null}},t}),$(function(){requirejs(["common/js/common/SiteSearch"],function(t){new t({box:"#siteSearch"})}),requirejs(["common/js/common/UserStatus"],function(t){new t({box:"#userStatus"})}),$(".nav li.nav-list-layer").on("mouseenter",function(){clearTimeout(this.timer),$(this).addClass("hover"),$(this).siblings(".hover").length>0&&$(this).siblings(".hover").removeClass("hover")}),$(".nav li.nav-list-layer").on("mouseleave",function(){var t=$(this);this.timer=setTimeout(function(){t.removeClass("hover")},500)})}),define("common/js/common/nav",function(){}),define("common/models/common/component/footerBanner/footerBanner",["require"],function(t){function e(){this.href=window.location.href,this.refer=document.referrer,this.source=null,this.isnew=this.getCookie("isnew"),this.init()}var i=jQuery;e.prototype={href:null,refer:null,source:null,isnew:null,init:function(){if(this.setSource(),window.QYER&&window.QYER.uid>0)return!1;var t,e;return t="m|login",e=new RegExp("^http://("+t+").(qyer|go2eu).com","i"),!e.test(this.href)&&(this.getHtml(),void this.setIsnew())},getHtml:function(){var t=this;i.get("/qcross/place/api.php?action=banner&url="+encodeURIComponent(this.href)+"&isnewuser="+this.isnew+"&source="+encodeURIComponent(this.getSource()),function(e){""!==e&&(i("body").append(e),t.bindEvent(),t=null)})},bindEvent:function(){var t=this;i(document).on("click","._jslogin",function(t){qyerUtil.doLogin()}).on("click","._jslogin_reg",function(t){qyerUtil.doSignin()}).on("click",".qyer_layer_close",function(e){i("._jsbeforelogindiv").fadeOut(1e3,function(){i(this).remove(),t=null})})},setCookie:function(t,e,i){window.qyerUtil.setCookie(t,e,i)},getCookie:function(t){return window.qyerUtil.getCookie(t)},setSource:function(){if(this.getSource(),!this.source){var t=".+",e=new RegExp("^http://("+t+").(qyer|go2eu).com","i");this.refer&&!e.test(this.refer)&&this.setCookie("source_url",this.refer),t=e=null}},getSource:function(){return this.source=this.getCookie("source_url"),this.source},setIsnew:function(){this.isnew||this.setCookie("isnew",(new Date).getTime())},beforeloginshow:function(){setTimeout(function(){i("._jsbeforelogindiv").fadeIn(500)},100)}};var s={show:function(){!window.banner&&(window.banner=new e)}};return s}),function(t,e){"function"==typeof define&&define.amd?define("common/js/common/Carousel",e):"object"==typeof exports?module.exports=e():t.Carousel=e()}(this,function(){function t(t){var t=$.extend({box:"#qyer_banner",carousel:"#carousel",bannerbg:"#bannerbg",speeds:5e3,onSlide:null},t);this.opts=t,this.$bannerBox=$(t.box),this.$carouselBox=$(t.carousel),this.$bannerbgBox=$(t.bannerbg),this.$carouselInner=null,this.$barLeft=null,this.$barRight=null,this.autoTimer=null,this.isImgLoaded=!1,this.init()}return t.prototype={init:function(){var t=this;return!(this.$carouselBox.find(".bannerimg").length<=1)&&(this.resizeCarousel(),setTimeout(function(){t.createLoadImg(t.$carouselBox.find(".bannerimg"))},2e3),void $(window).resize(function(e){t.resizeCarousel()}))},appendCarouselInner:function(){this.$carouselInner=$(this.createCarouselInner(this.$carouselBox.find(".carousel-data > li"))),this.$carouselBox.empty().append(this.$carouselInner).append(['<div class="bar left" style="height: '+scale_h+"px; line-height: "+scale_h+'px;">','<a class="iconfont icon-jiantou1zuo" data-bn-ipg="index-top-slideLeft" href="javascript:;"></a>',"</div>",'<div class="bar right" style="height: '+(scale_h-120)+"px; line-height: "+scale_h+'px;">','<a class="iconfont icon-jiantou1you" data-bn-ipg="index-top-slideRight" href="javascript:;"></a>',"</div>"].join("")),this.$barLeft=this.$carouselBox.find(".bar.left"),this.$barRight=this.$carouselBox.find(".bar.right")},createLoadImg:function(t){var e=0,i=this,s=function(){e++,e==t.length&&(i.appendCarouselInner(),i.bindEvent(),i.isImgLoaded=!0,i.autoSlider())};t.each(function(){var t=new Image;t.src=this.value,t.setAttribute("data-bannerimg",this.getAttribute("data-bannerimg")),t.complete?s():t.onload=function(){s()}})},imgAllLoaded:function(){var t=this,e=function(){t.$barLeft?(t.$barLeft.show().addClass("animationShow"),t.$barRight.show().addClass("animationShow")):setTimeout(function(){e()},10)};e()},createCarouselInner:function(t){var e=[],i=[];return t.each(function(e){var s="";s+="<li"+(0==e?' class="current"':"")+">",s+='<div class="img" style="width: '+scale_w+"px;background-image: url("+$(".bannerimg",this).val()+');">',s+='<input type="hidden" class="h_imgsrc" value="'+$(".bannerimg",this).val()+'">',s+='<input type="hidden" class="h_text" value="'+$(".bannertext",this).val()+'">',s+='<input type="hidden" class="h_url" value="'+$(".bannerurl",this).val()+'">',s+='<div class="hotlink" style="height: '+(scale_h-310)+'px;"><a data-bn-ipg="index-top-'+$(".bannertype",this).val()+"-"+$(".itemid",this).val()+'" href="'+$(".bannerlink",this).val()+'" target="_blank"></a></div>',s+='<div class="text-panel">',s+='<span class="num"><i>'+ ++e+"</i>/<em>"+t.length+"</em></span>",s+='<div class="text">',s+=$(".text",this).html(),s+="</div>",s+="</div>",s+="</div>",s+="</li>",i.push(s)}),e=['<div class="carousel-inner">',"<ul>",i.join(""),"</ul>","</div>"],e.join("")},bindEvent:function(){var t=this;this.$barLeft.bind("click",function(){t.stopAutoSlider(),t.slider("left")}),this.$barRight.bind("click",function(){t.stopAutoSlider(),t.slider("right")}),this.$bannerBox.bind("mouseleave",function(){t.isImgLoaded&&t.autoSlider()}).bind("mouseenter",function(){t.stopAutoSlider()})},getTargetLi:function(t,e){var i="right"==t?e.next().length?e.next():e.siblings().first():e.prev().length?e.prev():e.siblings().last();return i},slider:function(t){var e=this,i=this.$carouselInner.find(".current").length?this.$carouselInner.find(".current"):this.$carouselInner.find("li:first"),s=this.getTargetLi(t,i);i[0].className="transition "+t,s[0].className="current anim-"+t,i.animate({width:0},800,function(){this.style.width="",this.className="",e.opts.onSlide&&e.opts.onSlide.call(e,s)})},setSearch:function(t){this.$bannerBox.find(".place .txt").attr("placeholder",t.find(".h_text").val()),this.$bannerBox.find(".place .btn").attr("href",t.find(".h_url").val()?t.find(".h_url").val():"javascript:;")},autoSlider:function(){var t=this;clearInterval(this.autoTimer),this.autoTimer=setInterval(function(){t.slider("right")},t.opts.speeds)},stopAutoSlider:function(){clearInterval(this.autoTimer)},resizeCarousel:function(){scale_w=Math.max(document.body.clientWidth,document.documentElement.clientWidth),page_scale=scale_w/normal_w,scale_h=normal_h*page_scale,scale_w<=1160&&(scale_w=1160,page_scale=scale_w/normal_w,scale_h=normal_h*page_scale),scale_w>=normal_w&&(page_scale=1,scale_h=normal_h),this.$carouselBox.height(scale_h),this.$carouselBox.find(".hotlink").height(scale_h-310),this.$carouselInner&&this.$carouselInner.find("li,.img").width(scale_w).height(scale_h),this.$barLeft&&this.$barLeft.css({height:scale_h,"line-height":scale_h+"px"}),this.$barRight&&this.$barRight.css({height:scale_h-120,"line-height":scale_h+"px"})}},t}),function(t,e){"function"==typeof define&&define.amd?define("common/js/common/Slider",e):"object"==typeof exports?module.exports=e():t.Slider=e()}(this,function(){function t(t){this.opts=$.extend({box:".slider",speeds:5e3,onSlide:null,gradualShowClass:"gradually_col4_show"},t),this.$sliderBox=$(this.opts.box),this.$sliderInner=this.$sliderBox.find(".slider-inner"),this.$sliderControl=this.$sliderBox.find(".slider-control"),this.init()}return t.prototype={init:function(){this.bindEvent()},bindEvent:function(){var t=this;this.$sliderControl.on("mouseenter","a",function(){return!$(this).hasClass("current")&&void t.switchItem($(this))})},switchItem:function(t){t.addClass("current").siblings().removeClass("current"),this.$sliderInner.find(".item").hide().removeClass(this.opts.gradualShowClass).eq(t.index()).show().addClass(this.opts.gradualShowClass).find(".lazy").lazyload({effect:"fadeIn"})}},t}),function(t,e){"function"==typeof define&&define.amd?define("common/js/home/PlaceSearch",e):"object"==typeof exports?module.exports=e():t.PlaceSearch=e()}(this,function(){function t(t){this.opts=$.extend({box:"#search",placeSearchBox:".place_search_box",placeSearchHistory:".q-layer-placesearch-history"},t),this.$searchBox=$(this.opts.box),this.$placeSearchBox=$(this.opts.placeSearchBox),this.$history=$(this.opts.placeSearchHistory),this.$autocomplete=null,this.$input=$(".placesearch_txt"),this.$form=$(".place_search_form"),this.ajaxUrls={placesearch:"qcross/home/ajax?action=search"},this.searchTimer=null,this._history=[],this._search={},this.xhr=null,this.init()}return t.prototype={init:function(){this.createAutoComplete(),this.getStorage(),this.bindEvent(),this.$input.trigger("focus")},showHistory:function(){this.getHistory(),this.$history.addClass("show"),this.hideAutoComplete(),this.clickDocumentEvent(this.$searchBox[0],this.searchBoxClose)},getHistory:function(){if(!this._history.length)return!1;var t=['<div class="history-title">','<a class="fr history-clear" href="javascript:;">清空记录</a>',"<span>搜索记录</span>","</div>"];t.push('<div class="history-cont history">');for(var e=0;e<this._history.length;e++)t.push('<a data-bn-ipg="index-top-placeHistory-'+e+'" href="'+this._history[e].url+'" target="_blank">'+this._history[e].key+"</a>");t.push("</div>"),$(".placesearch_history_box").html(t.join(""))},hideHistory:function(){this.$history.removeClass("show")},createAutoComplete:function(){var t=$('<div class="q-layer q-layer-search-autocomplete q-layer-placesearch-autocomplete"><ul></ul></div');this.$searchBox.append(t),this.$autocomplete=t},showAutoComplete:function(){this.hideHistory(),this.$autocomplete.addClass("show"),this.clickDocumentEvent(this.$searchBox[0],this.searchBoxClose)},hideAutoComplete:function(){this.$autocomplete.removeClass("show")},hideLayer:function(){this.hideHistory(),this.hideAutoComplete()},bindEvent:function(){var t=this;this.$input.on("click",function(e,i){t.searchBoxActive()}),this.$input.on("keyup",function(e){if(9==e.keyCode||16==e.keyCode||17==e.keyCode||18==e.keyCode||20==e.keyCode||91==e.keyCode||93==e.keyCode)return!1;switch(e.keyCode){case 38:t.switchUpDown("up");break;case 40:t.switchUpDown("down");break;case 13:break;default:clearTimeout(t.searchTimer),t.setSearchLink(""),t.searchTimer=setTimeout(function(){""===t.getSearchWord()?(t.showHistory(),t.setSearchLink(t.getCarouselUrl())):(t.showAutoComplete(),t.searchWord(t.getSearchWord()))},400)}}),this.$autocomplete.on("mouseenter","li",function(){t.currentLayer($(this))}),this.$searchBox.on("click",".tab a",function(){t.hideLayer()}),this.$form.on("submit",function(){return""!=$(this).attr("action")&&void t.setStorage(t.getSearchWord(),t.getSearchLink())}),this.$history.on("click",".history-clear",function(){t.clearStorage()})},searchBoxActive:function(){""===this.getSearchWord()?this.showHistory():this.searchWord(this.getSearchWord())},searchBoxClose:function(){this.hideLayer()},clickDocumentEvent:function(t,e){var i=this,s="e_"+(new Date).getTime();$(document).unbind("click."+s),$(document).bind("click."+s,function(o){HomeUtil.isParent(o.target,t)||o.target==t||(e.call(i),$(document).unbind("click."+s))})},switchUpDown:function(t){this.$autocomplete.is(":visible")&&this.switchUpDownInAutoComplete(t)},switchUpDownInAutoComplete:function(t){var e=this.$autocomplete.find("li"),i=this.$autocomplete.find("li.current"),s=null;s="up"==t?i.length&&i.prev().length?i.prev():e.last():i.length&&i.next().length?i.next():e.first(),this.currentLayer(s)},currentLayer:function(t){t.addClass("current").siblings().removeClass("current"),this.setSearchLink(t.attr("data-url"))},getSearchWord:function(){return HomeUtil.fliterScript($.trim(this.$input.val()))},setSearchWord:function(t){this.$input.val(t)},getCarouselUrl:function(){return $("#carousel li.current .h_url").val()},getSearchLink:function(){return this.$form.attr("action")},setSearchLink:function(t){this.$form.attr("action",t)},getStorage:function(){if(window.localStorage&&window.localStorage.placesearch_history){var t=window.localStorage.placesearch_history;this._history=JSON.parse(t)}return this._history},setStorage:function(t,e){if(!window.localStorage||""==t)return!1;for(var i=-1,s=0;s<this._history.length;s++)if(this._history[s].key==t){i=s;break}i!=-1&&this._history.splice(s,1),this._history.unshift({key:t,url:e}),window.localStorage.placesearch_history=JSON.stringify(this._history)},clearStorage:function(){return!!window.localStorage&&(window.localStorage.removeItem("placesearch_history"),this._history=[],void this.$history.find(".history").empty())},searchWord:function(t){this._search[t]?this.setAutoComplete(this.$autocomplete,this._search[t]):(this.ajaxSearch(t),this.$autocomplete.html(this.ajaxLoading()))},ajaxSearch:function(t){var e=this,i={keyword:t,timer:(new Date).getTime()};$.getJSON(this.ajaxUrls.placesearch,i,function(i){0==i.error_code?i.data.keyword==e.getSearchWord()&&e.renderAutoComplete(e.$autocomplete,i.data,t):i.data.msg&&ajaxError(i.data.msg)})},renderAutoComplete:function(t,e,i){var s=[],o=0;if(s.push("<ul>"),!$.isEmptyObject(e.list))for(var n in e.list){var a=e.list[n];if("poi"==a.type_name)s.push('<li data-type="'+a.type_name+'" data-url="'+a.url+'">'),s.push('<div class="search-title">'),s.push('<a data-bn-ipg="index-top-placeThink-'+o+'" class="search-poi" href="'+a.url+'" target="_blank">'),s.push('<span class="fr">'+a.belong_name+"</span>"),s.push('<em class="cn">'+a.cn_name+'</em> <em class="en">'+a.en_name+"</em>"),s.push("</a>"),s.push("</div>"),s.push("</li>");else{s.push('<li data-type="'+a.type_name+'" data-url="'+a.url+'">'),s.push('<div class="search-title search-city-title">'),s.push('<a data-bn-ipg="index-top-placeThink-'+o+'" class="search-name" href="'+a.url+'" target="_blank">'),s.push('<span class="fr">'+a.belong_name+"</span>"),s.push('<em class="cn">'+a.cn_name+'</em> <em class="en">'+a.en_name+"</em>"),s.push("</a>"),s.push("</div>"),s.push('<div class="search-info">');for(var r=0;r<a.entry.length;r++){var l=a.entry[r];s.push('<a data-bn-ipg="index-top-placeThink-'+o+r+'" href="'+l.url+'" class="search-info-block" target="_blank">'),s.push('<i class="iconfont '+l["class"]+'"></i>'),s.push("<span>"+l.name+"</span>"),s.push("</a>")}s.push("</div>"),s.push("</li>")}o+=1}s.push('<li data-type="result-empty" data-url="//search.qyer.com/index?wd='+encodeURIComponent(i)+'"><div class="search-title"><a class="search-poi" href="//search.qyer.com/index?wd='+encodeURIComponent(i)+'" target="_blank">查看更多关于“<span style="color: #10B042;">'+i+"</span>”的搜索结果</a></div></li>"),s.push("</ul>"),s=s.join(""),t.html(s),this._search[i]={html:s,url:e.url},this.currentLayer(t.find("li:first")),this.hideHistory()},setAutoComplete:function(t,e){var i=e.html;t.html(i),this.currentLayer(t.find("li:first")),this.hideHistory(),this.showAutoComplete()},ajaxLoading:function(){return'<div class="loading"></div>'}},t}),function(t,e){"function"==typeof define&&define.amd?define("common/js/home/ZSearch",e):"object"==typeof exports?module.exports=e():t.ZSearch=e()}(this,function(){function t(t){this.opts=$.extend({box:"#search",zSearchBox:".place_search_box",zSearchHistory:".q-layer-zsearch-history"},t),this.$searchBox=$(this.opts.box),this.$zSearchBox=$(this.opts.zSearchBox),this.$history=$(this.opts.zSearchHistory),this.$autocomplete=null,this.$input=$(".zsearch_txt"),this.$form=$(".z_search_form"),this.ajaxUrls={zsearch:"qcross/home/ajax?action=zsearch"},this.searchTimer=null,this.cur_kw="",this._history=[],this._search={},this.xhr=null,this.init()}return t.prototype={init:function(){this.createAutoComplete(),this.getStorage(),this.bindEvent()},showHistory:function(){this.getHistory(),this.$history.addClass("show"),this.hideAutoComplete(),this.clickDocumentEvent(this.$searchBox[0],this.searchBoxClose)},getHistory:function(){if(!this._history.length)return!1;var t=['<div class="history-title">','<a class="fr history-clear" href="javascript:;">清空记录</a>',"<span>搜索记录</span>","</div>"];t.push('<div class="history-cont history">');for(var e=0;e<this._history.length;e++)t.push('<a data-bn-ipg="index-top-placeHistory-'+e+'" href="'+this._history[e].url+'" target="_blank">'+this._history[e].key+"</a>");t.push("</div>"),$(".zsearch_history_box").html(t.join(""))},hideHistory:function(){this.$history.removeClass("show")},createAutoComplete:function(){var t=$('<div class="q-layer q-layer-search-autocomplete q-layer-zsearch-autocomplete"><ul></ul></div');this.$searchBox.append(t),this.$autocomplete=t},showAutoComplete:function(){this.hideHistory(),this.$autocomplete.addClass("show"),this.clickDocumentEvent(this.$searchBox[0],this.searchBoxClose)},hideAutoComplete:function(){this.$autocomplete.removeClass("show"),this.cur_kw=""},hideLayer:function(){this.hideHistory(),this.hideAutoComplete()},bindEvent:function(){var t=this;this.$input.on("click",function(e,i){t.searchBoxActive()}),this.$input.on("keyup",function(e){if(9==e.keyCode||16==e.keyCode||17==e.keyCode||18==e.keyCode||20==e.keyCode||91==e.keyCode||93==e.keyCode)return!1;switch(e.keyCode){case 38:t.switchUpDown("up");break;case 40:t.switchUpDown("down");break;case 13:break;default:clearTimeout(t.searchTimer),t.searchTimer=setTimeout(function(){""===t.getSearchWord()?t.showHistory():(t.showAutoComplete(),t.searchWord(t.getSearchWord()))},400)}}),this.$input.on("keydown",function(t){13===t.keyCode&&qyerUtil.doTrackCode("index-top-lm-searchreturn")}),this.$autocomplete.on("mouseenter","li",function(){t.currentLayer($(this))}),this.$searchBox.on("click",".tab a",function(){t.hideLayer()}),this.$form.on("submit",function(){return""!=$(this).attr("action")&&(t.setStorage(t.getSearchWord(),t.getSearchLink()),void(t.cur_kw&&t.setSearchWord(t.cur_kw)))}),this.$history.on("click",".history-clear",function(){t.clearStorage()})},searchBoxActive:function(){""===this.getSearchWord()?this.showHistory():this.searchWord(this.getSearchWord())},searchBoxClose:function(){this.hideLayer()},clickDocumentEvent:function(t,e){var i=this,s="e_"+(new Date).getTime();$(document).unbind("click."+s),$(document).bind("click."+s,function(o){HomeUtil.isParent(o.target,t)||o.target==t||(e.call(i),$(document).unbind("click."+s))})},switchUpDown:function(t){this.$autocomplete.is(":visible")&&this.switchUpDownInAutoComplete(t)},switchUpDownInAutoComplete:function(t){var e=this.$autocomplete.find("li"),i=this.$autocomplete.find("li.current"),s=null;"up"==t?0==i.length||(s=0==i.prev().length?null:i.prev()):s=0==i.length?e.first():0==i.next().length?i:i.next(),this.currentLayer(s)},currentLayer:function(t){t?(t.addClass("current").siblings().removeClass("current"),this.cur_kw=t.attr("data-kw")):(this.$autocomplete.find("li").removeClass("current"),this.cur_kw="")},getSearchWord:function(){return HomeUtil.fliterScript($.trim(this.$input.val()))},setSearchWord:function(t){this.$input.val(t)},getCarouselUrl:function(){return $("#carousel li.current .h_url").val()},getSearchLink:function(){return this.$form.attr("action")},setSearchLink:function(t){this.$form.attr("action",t)},getStorage:function(){if(window.localStorage&&window.localStorage.zsearch_history){var t=window.localStorage.zsearch_history;this._history=JSON.parse(t)}return this._history;
},setStorage:function(t,e){if(!window.localStorage||""==t)return!1;for(var i=-1,s=0;s<this._history.length;s++)if(this._history[s].key==t){i=s;break}i!=-1&&this._history.splice(s,1),this._history.unshift({key:t,url:e}),window.localStorage.zsearch_history=JSON.stringify(this._history)},clearStorage:function(){return!!window.localStorage&&(window.localStorage.removeItem("zsearch_history"),this._history=[],void this.$history.find(".history").empty())},searchWord:function(t){this._search[t]?this.setAutoComplete(this.$autocomplete,this._search[t]):(this.ajaxSearch(t),this.$autocomplete.html(this.ajaxLoading()))},ajaxSearch:function(t){var e=this,i={keyword:t,timer:(new Date).getTime()};$.getJSON(this.ajaxUrls.zsearch,i,function(i){0==i.error_code?i.data.keyword==e.getSearchWord()&&e.renderAutoComplete(e.$autocomplete,i.data,t):i.data.msg&&ajaxError(i.data.msg)})},renderAutoComplete:function(t,e,i){var s=[],o=0;if(s.push("<ul>"),!$.isEmptyObject(e.list))for(var n in e.list){var a=e.list[n];if("tag"==a.type_name)s.push('<li data-type="'+a.type_name+'" data-url="'+a.url+'" data-kw="'+a.cn_name+'">'),s.push('<div class="search-title">'),s.push('<a data-bn-ipg="index-top-lmThink-'+o+'" class="search-tag" href="'+a.url+'" target="_blank">'),s.push('<span class="fr">'+a.belong_name+"</span>"),s.push('<em class="cn">'+a.cn_name+"</em>"),s.push("</a>"),s.push("</div>"),s.push("</li>");else{if(s.push('<li data-type="'+a.type_name+'" data-url="'+a.url+'" data-kw="'+a.cn_name+'">'),s.push('<div class="search-title search-city-title">'),s.push('<a data-bn-ipg="index-top-lmThink-'+o+'" class="search-name" href="'+a.url+'" target="_blank">'),s.push('<span class="fr">'+a.belong_name+"</span>"),s.push('<em class="cn">'+a.cn_name+'</em> <em class="en">'+a.en_name+"</em>"),s.push("</a>"),s.push("</div>"),s.push('<div class="search-info">'),a.entry&&a.entry.length)for(var r=0;r<a.entry.length;r++){var l=a.entry[r];s.push('<a data-bn-ipg="index-top-lmThink-'+o+r+'" href="'+l.url+'" class="search-info-block" target="_blank">'),s.push('<i class="iconfont '+l["class"]+'"></i>'),s.push("<span>"+l.name+"</span>"),s.push("</a>")}s.push("</div>"),s.push("</li>")}o+=1}s.push("</ul>"),s=s.join(""),t.html(s),this._search[i]={html:s,url:e.url},this.hideHistory()},setAutoComplete:function(t,e){var i=e.html;t.html(i),this.hideHistory(),this.showAutoComplete()},ajaxLoading:function(){return'<div class="loading"></div>'}},t}),function(t,e){"function"==typeof define&&define.amd?define("common/js/home/HotelSearch",e):"object"==typeof exports?module.exports=e():t.HotelSearch=e()}(this,function(){function t(t){this.opts=$.extend({box:"#search",hotelSearchBox:".hotel_search_box",hotelSearchHistory:".q-layer-hotelsearch-history"},t),this.$searchBox=$(this.opts.box),this.$hotelSearchHistory=$(this.opts.hotelSearchHistory),this.$history=$(this.opts.hotelSearchHistory),this.$autocomplete=null,this.$input=$(".hotelsearch_txt"),this.$form=$(".hotel_search_form"),this.$btn=$(".hotel_btn"),this.ajaxUrls={hotelsearch:"qcross/home/ajax?action=hotelsearch"},this.searchTimer=null,this._history=[],this._search={},this.xhr=null,this.init()}return t.prototype={init:function(){this.createAutoComplete(),this.getStorage(),this.bindEvent(),this.$form.find(".date_txt").each(function(){this.value=""})},bindEvent:function(){var t=this;requirejs(["common/js/home/hotelDatepicker"]),this.$input.on("click",function(e,i){t.searchBoxActive()}).on("input",function(){""===this.value&&(this.removeAttribute("data-name"),this.removeAttribute("data-url"))}).on("blur",function(){this.value=this.getAttribute("data-name"),t.$autocomplete.find(".loading").length&&t.hideAutoComplete()}).on("keyup",function(e){if(9==e.keyCode||16==e.keyCode||17==e.keyCode||18==e.keyCode||20==e.keyCode||91==e.keyCode||93==e.keyCode)return!1;switch(e.keyCode){case 38:t.switchUpDown("up");break;case 40:t.switchUpDown("down");break;case 13:this.blur(),t.$btn.trigger("click",[!0]);break;default:clearTimeout(t.searchTimer),t.searchTimer=setTimeout(function(){""===t.getSearchWord()?t.showHistory():(t.showAutoComplete(),t.searchWord(t.getSearchWord()))},400)}}),this.$autocomplete.on("mouseenter","li",function(){t.currentLayer($(this))}),this.$autocomplete.on("click","li",function(){t.$input.val($(this).attr("data-name")),t.setSearchWord($(this)),t.hideLayer()}),this.$form.on("submit",function(){return!1}),this.$searchBox.on("click",".tab a",function(){t.hideLayer()}),this.$btn.on("click",function(e,i){var s,o,n=t.$input.attr("data-url"),a=t.$input.attr("data-name");return!!n&&(t.setStorage(a,n),s=t.$form.find("[name=checkin]").val().trim().split("-"),o=t.$form.find("[name=checkout]").val().trim().split("-"),s&&(n=t.addUrlParam(n,"checkin_year",s[0]),n=t.addUrlParam(n,"checkin_month",s[1]),n=t.addUrlParam(n,"checkin_monthday",s[2]),o&&(n=t.addUrlParam(n,"checkout_year",o[0]),n=t.addUrlParam(n,"checkout_month",o[1]),n=t.addUrlParam(n,"checkout_monthday",o[2]))),this.href=n,void(i&&window.open(n)))}),this.$history.on("click",".history-clear",function(){t.clearStorage()}),this.$history.on("click","a:not(.history-clear)",function(){return t.$input.val(this.innerHTML),t.$input.attr({"data-name":this.innerHTML,"data-url":this.getAttribute("href")}),t.hideHistory(),!1})},createAutoComplete:function(){var t=$('<div class="q-layer q-layer-search-autocomplete q-layer-hotelsearch-autocomplete"><ul></ul></div');this.$searchBox.append(t),this.$autocomplete=t},searchBoxActive:function(){""===this.getSearchWord()?this.showHistory():(this.showAutoComplete(),this.searchWord(this.getSearchWord()))},switchUpDown:function(t){this.$autocomplete.is(":visible")&&this.switchUpDownInAutoComplete(t)},switchUpDownInAutoComplete:function(t){var e=this.$autocomplete.find("li"),i=this.$autocomplete.find("li.current"),s=null;s="up"==t?i.length&&i.prev().length?i.prev():e.last():i.length&&i.next().length?i.next():e.first(),this.$input.val(s.attr("data-name")),this.setSearchWord(s),this.currentLayer(s)},showHistory:function(){this.getHistory(),this.$history.addClass("show"),this.hideAutoComplete(),this.clickDocumentEvent(this.$searchBox[0],this.searchBoxClose)},hideHistory:function(){this.$history.removeClass("show")},hideLayer:function(){this.hideHistory(),this.hideAutoComplete()},getHistory:function(){if(!this._history.length)return!1;var t=['<div class="history-title">','<a class="fr history-clear" href="javascript:;">清空记录</a>',"<span>搜索记录</span>","</div>"];t.push('<div class="history-cont history">');for(var e=0;e<this._history.length;e++)t.push('<a data-bn-ipg="index-top-hotelHistory-'+e+'" href="'+this._history[e].url+'" target="_blank">'+this._history[e].key+"</a>");t.push("</div>"),$(".hotelsearch_history_box").html(t.join(""))},getSearchWord:function(){return HomeUtil.fliterScript($.trim(this.$input.val()))},setSearchWord:function(t){this.$input.attr({"data-name":t.attr("data-name"),"data-url":t.attr("data-url")})},showAutoComplete:function(){this.hideHistory(),this.$autocomplete.addClass("show"),this.clickDocumentEvent(this.$searchBox[0],this.searchBoxClose)},hideAutoComplete:function(){this.$autocomplete.removeClass("show")},getStorage:function(){if(window.localStorage&&window.localStorage.hotelsearch_history){var t=window.localStorage.hotelsearch_history;this._history=JSON.parse(t)}return this._history},setStorage:function(t,e){if(!window.localStorage||""==t)return!1;for(var i=-1,s=0;s<this._history.length;s++)if(this._history[s].key==t){i=s;break}i!=-1&&this._history.splice(s,1),this._history.unshift({key:t,url:e}),window.localStorage.hotelsearch_history=JSON.stringify(this._history)},clearStorage:function(){return!!window.localStorage&&(window.localStorage.removeItem("hotelsearch_history"),this._history=[],void this.$history.find(".history").empty())},searchWord:function(t){this._search[t]?this.setAutoComplete(this.$autocomplete,this._search[t]):(this.ajaxSearch(t),this.$autocomplete.html(this.ajaxLoading()))},ajaxSearch:function(t){var e=this,i={keyword:t,timer:(new Date).getTime()};$.getJSON(this.ajaxUrls.hotelsearch,i,function(i){0==i.error_code?i.data.keyword==e.getSearchWord()&&e.renderAutoComplete(e.$autocomplete,i.data,t):i.data.msg&&ajaxError(i.data.msg)})},renderAutoComplete:function(t,e,i){var s,o=[],n=0;if(o.push("<ul>"),$.isEmptyObject(e.list))this.$btn.prop("disabled",!0);else for(var a in e.list){var r=e.list[a];o.push('<li data-url="'+r.url+'" data-name="'+(r.cn_name?r.cn_name:r.en_name)+'">'),o.push('<div class="search-title">'),o.push('<a data-bn-ipg="index-top-hotelThink-'+n+'" class="search-tag" href="javascript:;">'),r.count&&r.count>0&&o.push('<span class="fr">'+r.count+"家酒店</span>"),r.cn_name&&o.push('<em class="cn">'+r.cn_name+"</em>"),r.en_name&&o.push('&nbsp;<em class="en">'+r.en_name+"</em>"),r.parent&&o.push('&nbsp;<em class="en">'+r.parent+"</em>"),o.push("</a>"),o.push("</div>"),o.push("</li>"),n+=1}o.push("</ul>"),o=o.join(""),t.html(o),this._search[i]={html:o,url:e.url},s=t.find("li:first"),this.setSearchWord(s),this.currentLayer(s),this.hideHistory()},setAutoComplete:function(t,e){var i,s=e.html;t.html(s),i=t.find("li:first"),this.setSearchWord(i),this.currentLayer(i),this.hideHistory(),this.showAutoComplete()},searchBoxClose:function(){this.hideLayer()},currentLayer:function(t){t.addClass("current").siblings().removeClass("current")},getSearchLink:function(){return this.$form.find("[name=url]").val()},setSearchLink:function(t){this.$form.find("[name=url]").val(t)},clickDocumentEvent:function(t,e){var i=this,s="e_"+(new Date).getTime();$(document).unbind("click."+s),$(document).bind("click."+s,function(o){HomeUtil.isParent(o.target,t)||o.target==t||(e.call(i),$(document).unbind("click."+s))})},ajaxLoading:function(){return'<div class="loading"></div>'},addUrlParam:function(t,e,i){var s=t.indexOf("?")===-1?"?":"&";return t+encodeURIComponent(s+e+"="+i)}},t}),define("common/models/basic/js/normalize",[],function(){function t(t,i,o){if(t.match(r)||t.match(a))return t;t=n(t);var l=o.match(a),h=i.match(a);return!h||l&&l[1]==h[1]&&l[2]==h[2]?s(e(t,i),o):e(t,i)}function e(t,e){if("./"==t.substr(0,2)&&(t=t.substr(2)),t.match(r)||t.match(a))return t;var i=e.split("/"),s=t.split("/");for(i.pop();curPart=s.shift();)".."==curPart?i.pop():i.push(curPart);return i.join("/")}function s(t,e){var s=e.split("/");for(s.pop(),e=s.join("/")+"/",i=0;e.substr(i,1)==t.substr(i,1);)i++;for(;"/"!=e.substr(i,1);)i--;e=e.substr(i+1),t=t.substr(i+1),s=e.split("/");var o=t.split("/");for(out="";s.shift();)out+="../";for(;curPart=o.shift();)out+=curPart+"/";return out.substr(0,out.length-1)}var o=/([^:])\/+/g,n=function(t){return t.replace(o,"$1/")},a=/[^\:\/]*:\/\/([^\/])*/,r=/^(\/|data:)/,l=function(e,i,s){i=n(i),s=n(s);for(var o,a,e,r=/@import\s*("([^"]*)"|'([^']*)')|url\s*\((?!#)\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/gi;o=r.exec(e);){a=o[3]||o[2]||o[5]||o[6]||o[4];var l;l=t(a,i,s);var h=o[5]||o[6]?1:0;e=e.substr(0,r.lastIndex-a.length-h-1)+l+e.substr(r.lastIndex-h-1),r.lastIndex=r.lastIndex+(l.length-a.length)}return e};return l.convertURIBase=t,l.absoluteURI=e,l.relativeURI=s,l}),define("common/models/basic/js/require-css",[],function(){if("undefined"==typeof window)return{load:function(t,e,i){i()}};var t=document.getElementsByTagName("head")[0],e=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)|AndroidWebKit\/([^ ;]*)/)||0,i=!1,s=!0;e[1]||e[7]?i=parseInt(e[1])<6||parseInt(e[7])<=9:e[2]||e[8]?s=!1:e[4]&&(i=parseInt(e[4])<18);var o={};o.pluginBuilder="./css-builder";var n,a,r,l=function(){n=document.createElement("style"),t.appendChild(n),a=n.styleSheet||n.sheet},h=0,c=[],u=function(t){h++,32==h&&(l(),h=0),a.addImport(t),n.onload=function(){d()}},d=function(){r();var t=c.shift();return t?(r=t[1],void u(t[0])):void(r=null)},p=function(t,e){if(a&&a.addImport||l(),a&&a.addImport)r?c.push([t,e]):(u(t),r=e);else{n.textContent='@import "'+t+'";';var i=setInterval(function(){try{n.sheet.cssRules,clearInterval(i),e()}catch(t){}},10)}},m=function(e,i){var o=document.createElement("link");if(o.type="text/css",o.rel="stylesheet",s)o.onload=function(){o.onload=function(){},setTimeout(i,7)};else var n=setInterval(function(){for(var t=0;t<document.styleSheets.length;t++){var e=document.styleSheets[t];if(e.href==o.href)return clearInterval(n),i()}},10);o.href=e,t.appendChild(o)};return o.normalize=function(t,e){return".css"==t.substr(t.length-4,4)&&(t=t.substr(0,t.length-4)),e(t)},o.load=function(t,e,s,o){(i?p:m)(e.toUrl(t+".css"),s)},o}),define("common/models/basic/js/require-css!web_old_tip",[],function(){}),define("web_old_tip",["css!web_old_tip"],function(){function t(t){s.html(t.text||"&nbsp;"),i[0].className="qui-tip-box","error"==t.type?i.addClass("qui-tip-box-error"):"warning"==t.type&&i.addClass("qui-tip-box-warning")}var e,i,s,o=jQuery;!function(){var t=['<div class="qui-tip" style="display:none;" >','<div class="qui-tip-box">','<span class="qui-tip-text fontYaHei">这里是提示文本</span>',"</div>","</div>"].join("");e=o(t),s=e.find(".qui-tip-text"),i=e.find(".qui-tip-box"),e.appendTo(document.body)}();var n={_timer:null,tip:function(i){return t(i),e.slideDown(200),window.clearTimeout(this._timer),this._timer=setTimeout(function(){e.slideUp(200)},i.time||3e3),this}};return n}),define("common/js/home/Interest",["common/js/common/Slider","web_old_tip"],function(t,e){function i(t){this.opts=$.extend({box:"#interest"},t),this.ajaxUrls={interest:"qcross/home/ajax?action=guess",uninterest:"qcross/home/ajax?action=notinterest"},this.$interestBox=$(t.box),this.uid=null,this.ajaxLoad=!1,this.draft=null,this.init()}return i.prototype={init:function(){this.ajaxInterest(!0),this.bindEvent()},ajaxInterest:function(t){var e=this,i={timer:+new Date};$.getJSON(this.ajaxUrls.interest,i,function(i){0===i.error_code&&(e.uid=i.data.uid,e.renderInterest(i.data.list,t,i.data.requestId),e.draft=i.data.draft)})},ajaxUnInterest:function(t){var e=t.parent(),i=this,s={groupid:t.attr("data-group"),item_id:t.attr("data-id"),type:t.attr("data-type"),timer:(new Date).getTime()};$.getJSON(this.ajaxUrls.uninterest,s,function(t){0===t.error_code&&i.renderItem(e,t.data.item)})},renderInterest:function(t,e,i){var s,o=['<a class="change" data-bn-ipg="index-guess-change" data-ra_arg="'+i+'|0" data-requestid="'+i+'" href="javascript:;"><i class="iconfont icon-shuaxin"></i> 换一换</a>'];o.push('<div class="interest_inner">'),o.push(this.getInterestInner(t)),o.push("</div>"),s=$(o.join("")),0===this.uid&&s.find("li").eq(3).addClass("li_login").html(this.getLoginInner()),this.$interestBox.html(s),$("img.lazy:visible",this.$interestBox).lazyload({effect:"fadeIn"})},renderItem:function(t,e){t.append(this.getItemInner(e,"sub"))},getInterestInner:function(t){for(var e=[],i=0;i<t.length;i++){e.push("<ul"+(0===i?' style="display: block;" class="gradually_col4_show"':"")+">");for(var s=0;s<t[i].length;s++)e.push("<li>"),e.push(this.getItemInner(t[i][s],i,s)),e.push("</li>");e.push("</ul>")}return e.join("")},getItemInner:function(t,e,i,s){var o=[];return o.push('<div class="item '+(s?s:"")+'" data-group="'+e+'" data-index="'+i+'" data-type="'+t.type+'" data-id="'+t.id+'">'),o.push('<a class="close iconfont icon-wrong" data-bn-ipg="index-guess-dislike-'+t.type+'" href="javascript:;" title="并不感兴趣" data-ra_arg="'+t.ra_arg+'"></a>'),o.push('<div class="img">'),o.push('<a data-bn-ipg="index-guess-pic'+e+i+"-"+t.type+"-"+t.id+'" data-ra_arg="'+t.ra_arg+'" href="'+t.url+'" target="_blank">'),s?o.push('<img src="'+t.pic+'" width="275" height="185">'):o.push('<img class="lazy" src="images/grey.gif" data-original="'+t.pic+'" width="275" height="185">'),o.push('<div class="bg">'),o.push('<div class="p"></div>'),o.push("<span>"+t.reason+"</span>"),o.push("</div>"),o.push('<div class="tag">'),o.push('<span><i class="iconfont '+t["class"]+'"></i></span>'),o.push('<span class="bt">'+t.subtype+"</span>"),o.push("</div>"),o.push("</a>"),o.push("</div>"),o.push('<div class="info">'),o.push('<a data-bn-ipg="index-guess-title'+e+i+"-"+t.type+"-"+t.id+'" data-ra_arg="'+t.ra_arg+'" href="'+t.url+'" target="_blank">'),o.push('<div class="subtitle">'),"undefined"!=typeof t.title?o.push("<p>"+t.title+"</p>"):(t.cn_name&&o.push('<p class="ellipsis">'+t.cn_name+"</p>"),t.en_name&&o.push('<p class="ellipsis"><span>'+t.en_name+"</span></p>")),o.push("</div>"),o.push('<div class="bottom">'),o.push('<span class="fr">'+this.getItemRightInner(t)+"</span>"),o.push('<span class="f14">'+this.getItemLeftInner(t)+"</span>"),o.push("</div>"),o.push("</a>"),o.push("</div>"),o.push("</div>"),o.join("")},getItemLeftInner:function(t){return t.text?t.text:t.username?t.username:t.place?t.place:""},getItemRightInner:function(t){return"poi"==t.type?t.ranking:"city"==t.type?t.been_to_counts+"个人去过这里":"plan"==t.type?t.been_to_counts:"skus"==t.type?t.price:"threads"==t.type?t.total_views+"人浏览过":"mguide"==t.type?t.poi_count:""},getLoginInner:function(){var t,e=['<div class="login">','<div class="login-title">',"<h3>让我们更懂你</h3>","<p>拥有穷游账号，获得更准确的推荐</p>","</div>",'<div class="login-link">','<a data-bn-ipg="index-guess-un-register" href="javascript:;" class="register-btn register-phone">立即注册</a>',"<span>",'已有帐号？<a data-bn-ipg="index-guess-un-login" class="login-mail" href="javascript:;">登录</a>',"</span>","</div>",'<div class="auth-login">','<a data-bn-ipg="index-guess-un-email" class="register-mail" href="javascript:;">使用邮箱注册</a>','<a data-bn-ipg="index-guess-un-qq" data-type="qq" href="javascript:;" class="login-auth iconfont icon-qq1"></a>','<a data-bn-ipg="index-guess-un-weibo" data-type="weibo" href="javascript:;" class="login-auth iconfont icon-weibo1"></a>','<a data-bn-ipg="index-guess-un-wechat" data-type="weixin" href="javascript:;" class="login-auth iconfont icon-weixin1"></a>',"</div>","</div>"].join("");return t=$(e),t.on("click",".register-phone",function(){qyerUtil.doSignin({pageType:"phone"})}).on("click",".register-mail",function(){qyerUtil.doSignin()}).on("click",".login-mail",function(){qyerUtil.doLogin()}).on("click",".login-auth",function(){HomeUtil.otherlogin(this.getAttribute("data-type"))}).on("mouseover",".login-auth",function(){/qq1/.test(this.className)&&$(this).addClass("icon-qq2"),/weixin1/.test(this.className)&&$(this).addClass("icon-weixin2"),/weibo1/.test(this.className)&&$(this).addClass("icon-weibo2")}).on("mouseout",".login-auth",function(){/qq2/.test(this.className)&&$(this).removeClass("icon-qq2"),/weixin2/.test(this.className)&&$(this).removeClass("icon-weixin2"),/weibo2/.test(this.className)&&$(this).removeClass("icon-weibo2")}),t},bindEvent:function(){var t=this;this.$interestBox.on("click",".change",function(){var e=t.$interestBox.find(".interest_inner > ul:visible").hide().removeClass("gradually_col4_show").next();e.length||(e=t.$interestBox.find(".interest_inner > ul:first")),this.setAttribute("data-ra_arg",this.getAttribute("data-requestid")+"|"+e.index()),e.show().addClass("gradually_col4_show").find("img.lazy").lazyload({effect:"fadeIn"})}),this.$interestBox.on("click",".close",function(){t.uid>0?t.unInterest($(this).closest(".item")):qyerUtil.doLogin()})},unInterest:function(t){var i=this,s=t.attr("data-type"),o=t.attr("data-group"),n=t.attr("data-id"),a=t.attr("data-index"),r=t.find(".tag .bt").html(),l=null,h=null,c={groupid:o,item_id:n,type:s,timer:+new Date},u="plan"===s?"skus":s;this.draft[u]&&this.draft[u].length?(h=this.draft[u].splice(0,1),l=$(this.getItemInner(h[0],o,a,"sub")),t.prev().remove(),t.after(l),setTimeout(function(){i.changeItem(t,l)},10),$.getJSON(this.ajaxUrls.uninterest,c,function(t){0===t.error_code})):e.tip({text:"今天没有更多"+r+"推荐了，明天再来看看吧～",type:"warning"})},changeItem:function(t,e){t.addClass("del"),e.removeClass("sub")},ajaxLoading:function(){return'<div class="sk-wave"><div class="sk-rect sk-rect1"></div> <div class="sk-rect sk-rect2"></div> <div class="sk-rect sk-rect3"></div> <div class="sk-rect sk-rect4"></div> <div class="sk-rect sk-rect5"></div></div>'}},i}),define("common/js/common/FlipTimer",[],function(){function t(t){this.opts=$.extend({box:".flip-box",isFlip:!0},t),this.$flipBox=$(this.opts.box),this.flipTimer=this.opts.datetime||this.$flipBox.attr("data-timer")||"",this.timer=null,this.init()}return t.prototype={init:function(){var t=this;this.createFlipInner(),this.opts.isFlip&&(this.endDate=new Date(this.flipTimer),this.endTime=this.endDate.getTime(),setTimeout(function(){t.updateTime()},0))},updateTime:function(){var t=this,e=(new Date).getTime(),i=this.endTime-e,s={hour:this.timeToString(Math.floor(i/1e3/60/60%24)),minute:this.timeToString(Math.floor(i/1e3/60%60)),second:this.timeToString(Math.floor(i/1e3%60))};if(s.hour<99&&i>1){for(var o in s)this.setTimes(o,s[o]);this.timer=setTimeout(function(){t.updateTime()},1e3)}else"function"==typeof this.opts.timeEndCallback&&this.opts.timeEndCallback()},stopTime:function(){var t=this;clearTimeout(this.timer),this.$flipBox.html(""),setTimeout(function(){t.createFlipInner()},365)},createFlipInner:function(){var t=['<div class="flip-group">','<div class="flip-digit">','<span class="num top hour-tens-top">0</span>','<span class="num bottom hour-tens-bottom"><i>0</i></span>','<div class="flip-swapper hour-tens-swapper">','<span class="num top hour-tens-top-anim">0</span>','<span class="num bottom hour-tens-bottom-anim"><i>0</i></span>',"</div>","</div>",'<div class="flip-digit">','<span class="num top hour-ones-top">0</span>','<span class="num bottom hour-ones-bottom"><i>0</i></span>','<div class="flip-swapper hour-ones-swapper">','<span class="num top hour-ones-top-anim">0</span>','<span class="num bottom hour-ones-bottom-anim"><i>0</i></span>',"</div>","</div>","</div>",'<div class="flip-colon">:</div>','<div class="flip-group">','<div class="flip-digit">','<span class="num top minute-tens-top">0</span>','<span class="num bottom minute-tens-bottom"><i>0</i></span>','<div class="flip-swapper minute-tens-swapper">','<span class="num top minute-tens-top-anim">0</span>','<span class="num bottom minute-tens-bottom-anim"><i>0</i></span>',"</div>","</div>",'<div class="flip-digit">','<span class="num top minute-ones-top">0</span>','<span class="num bottom minute-ones-bottom"><i>0</i></span>','<div class="flip-swapper minute-ones-swapper">','<span class="num top minute-ones-top-anim">0</span>','<span class="num bottom minute-ones-bottom-anim"><i>0</i></span>',"</div>","</div>","</div>",'<div class="flip-colon">:</div>','<div class="flip-group">','<div class="flip-digit">','<span class="num top second-tens-top">0</span>','<span class="num bottom second-tens-bottom"><i>0</i></span>','<div class="flip-swapper second-tens-swapper">','<span class="num top second-tens-top-anim">0</span>','<span class="num bottom second-tens-bottom-anim"><i>0</i></span>',"</div>","</div>",'<div class="flip-digit">','<span class="num top second-ones-top">0</span>','<span class="num bottom second-ones-bottom"><i>0</i></span>','<div class="flip-swapper second-ones-swapper">','<span class="num top second-ones-top-anim">0</span>','<span class="num bottom second-ones-bottom-anim"><i>0</i></span>',"</div>","</div>","</div>"].join("");this.$flipBox.html(t)},setTimes:function(t,e){this.setTime(this.getPreviousTime(t+"-tens"),e[0],t+"-tens"),this.setTime(this.getPreviousTime(t+"-ones"),e[1],t+"-ones")},setTime:function(t,e,i){t!==e&&(setTimeout(function(){$("."+i+"-top",this.$flipBox).text(e)},150),setTimeout(function(){$("."+i+"-bottom > i",this.$flipBox).text(e)},365),this.animateTime(t,e,i))},animateTime:function(t,e,i){var s,o,n=this;s=$("."+i+"-top-anim",this.$flipBox),o=$("."+i+"-bottom-anim",this.$flipBox),s.show(),o.show(),s.text(t),o.find("i").text(e),this.animateNumSwap(i),setTimeout(function(){n.hideNumSwap(i)},365)},animateNumSwap:function(t){$("."+t+"-swapper").addClass("animate")},hideNumSwap:function(t){$("."+t+"-swapper").removeClass("animate"),$("."+t+"-top-anim",this.$flipBox).hide(),$("."+t+"-bottom-anim",this.$flipBox).hide()},getPreviousTime:function(t){return $("."+t+"-top",this.$flipBox).text()},timeToString:function(t){var e;return e=t.toString(),1===e.length?"0"+e:e}},t}),define("common/js/home/Lastminute",["common/js/common/Slider","common/js/common/FlipTimer"],function(t,e){function i(t){this.opts=$.extend({box:"#lastminute"},t),this.ajaxUrls={lastminute:"qcross/home/ajax?action=lastmin",lmhour:"qcross/home/ajax?action=lmhour"},this.$lastminuteBox=$(t.box),this.$buytodayContainer=this.$lastminuteBox.find(".buytoday-container"),this.$buytoday=null,this.sliderLen=0,this.init()}return i.prototype={init:function(){this.loadLastminute()},loadLastminute:function(){var t=this,e={timer:(new Date).getTime()};$.getJSON(this.ajaxUrls.lastminute,e,function(e){0===e.error_code&&t.renderLastminute(e.data.item)})},renderLastminute:function(t){var e,i=[],s=[];this.sliderLen=Math.ceil((t.length+2)/6),s.push('<div class="slider-control">'),i.push('<div class="slider slider-lastminute">'),i.push('<div class="slider-inner">');for(var o=0;o<this.sliderLen;o++){i.push('<div class="item'+(0===o?" active":"")+'">'),i.push("<ul>");var n=0;for(0===o&&(i.push('<li class="buytoday"></li>'),n=2),n;n<6;n++){var a=n+6*o-2;if(!t[a])break;i.push("<li data-index="+a+">"),i.push(this.getItemInner(t[a],""+o+n)),i.push("</li>")}i.push("</ul>"),i.push("</div>"),s.push("<a"+(0===o?' class="current"':"")+' data-bn-ipg="index-world-page" href="javascript:;"></a>')}i.push("</div>"),s.push("</div>"),i.push(s.join("")),i.push("</div>"),i.push('<div class="more">'),i.push('<a href="//z.qyer.com/" data-bn-ipg="index-world-more" target="_blank">查看更多折扣</a>'),i.push("</div>"),e=$(i.join("")),this.$buytoday=e.find(".buytoday"),this.addBuyToday(this.$buytodayContainer.find(".buytoday:first")),this.$lastminuteBox.find(".sk-wave").hide(),this.$lastminuteBox.append(e),this.bindEvent()},getItemInner:function(t,e){return['<a data-bn-ipg="index-world-zhe-'+e+"-"+t.id+'" href="'+t.url+'" target="_blank" data-ra_arg="'+t.ra_arg+'"><div class="discount" data-id="'+t.id+'">','<img class="lazy img" src="images/grey.gif" data-original="'+t.imgsrc+'" width="120" height="120">','<div class="inner">','<div class="caption">',""+t.title,"</div>",'<div class="st">','<span class="time">'+t.datetime+"</span>",'<span class="tag">'+t.tag+"</span>","</div>",'<div class="price">',"<span>"+t.price+"</span>","</div>","</div>","</div></a>"].join("")},bindEvent:function(){new t({box:".slider-lastminute",gradualShowClass:"gradually_col3_show"}),$("img.lazy:visible",this.$lastminuteBox).lazyload({effect:"fadeIn"})},addBuyToday:function(t){var i,s=this,o=t.find(".flip-box"),n=t.find(".btn"),a=t.find(".disabled"),r=t.attr("data-id"),l=new Date,h=new Date(o.attr("data-timer-start")),c=new Date(o.attr("data-timer-end")),u={box:o},d=null,p=function(){var t=s.$buytodayContainer.find(".buytoday:first");t.length?s.addBuyToday(t):(n.hide(),a.text("已抢光").show())},m=function(){$.getJSON(s.ajaxUrls.lmhour,{id:r,timer:+l}).done(function(t){0===t.error_code&&(1==t.data.onsale?(n.show(),a.hide(),setTimeout(m,6e4)):(n.hide(),a.text("已抢光").show(),d&&d.stopTime()))})};if(o.attr("data-timer-next")&&(i=new Date(o.attr("data-timer-next"))),this.$buytoday.html(t),l<h)u=$.extend(u,{isFlip:!0,datetime:h,timeEndCallback:function(){m()}}),a.text("马上开抢").show();else if(l<c)0==t.attr("data-isonline")?u.isFlip=!1:u=$.extend(u,{isFlip:!0,datetime:c,timeEndCallback:function(){p()}}),t.find("h3").html("限时秒杀"),m();else if(i){if(!(i-l<=36e5&&c!=i))return void p();u.isFlip=!1,a.text("已抢光").show(),setTimeout(p,i-l)}else u.isFlip=!1,a.show();d=new e(u)}},i}),define("common/js/home/Lastminute_b",["common/js/common/Slider"],function(t){function e(t){this.opts=$.extend({box:"#lastminute"},t),this.ajaxUrls={lastminute:"qcross/home/ajax?action=lastmin",lmhour:"qcross/home/ajax?action=lmhour"},this.$lastminuteBox=$(t.box),this.$buytodayContainer=this.$lastminuteBox.find(".buytoday-container"),this.$buytoday=null,this.sliderLen=0,this.init()}return e.prototype={init:function(){this.loadLastminute()},loadLastminute:function(){var t=this,e={abtest:"b",timer:(new Date).getTime()};$.getJSON(this.ajaxUrls.lastminute,e,function(e){0===e.error_code&&t.renderLastminute(e.data.item)})},renderLastminute:function(t){var e,i=[],s=[],o=0;this.sliderLen=Math.ceil(t.length/6),i.push('<div class="slider slider-lastminute">'),s.push('<div class="slider-control">'),i.push('<div class="slider-inner">'),i.push('<div class="item active">'),i.push("<ul>"),i.push('<li class="buytoday">'),i.push("</li>"),i.push('<li class="buytoday">'),i.push("</li>"),i.push('<li class="buytoday">'),i.push("</li>"),i.push("</ul>"),i.push("</div>"),s.push('<a class="current" data-bn-ipg="index-world-page" href="javascript:;"></a>');for(var n=0;n<this.sliderLen;n++){i.push('<div class="item">'),i.push("<ul>");for(var a=0;a<6;a++)i.push("<li data-index="+o+">"),i.push(this.getItemInner(t[o],""+(n+1)+a)),i.push("</li>"),o++;i.push("</ul>"),i.push("</div>"),s.push('<a data-bn-ipg="index-world-page" href="javascript:;"></a>')}i.push("</div>"),s.push("</div>"),i.push(s.join("")),i.push("</div>"),i.push('<div class="more">'),i.push('<a href="//z.qyer.com/" data-bn-ipg="index-world-more" target="_blank">查看更多折扣</a>'),i.push("</div>"),e=$(i.join("")),this.addBuyToday(e,this.$buytodayContainer),this.$lastminuteBox.find(".sk-wave").hide(),this.$lastminuteBox.append(e),this.bindEvent()},getItemInner:function(t,e){return['<a data-bn-ipg="index-world-zhe-'+e+"-"+t.id+'" href="'+t.url+'" target="_blank" data-ra_arg="'+t.ra_arg+'"><div class="discount" data-id="'+t.id+'">','<img class="lazy img" src="images/grey.gif" data-original="'+t.imgsrc+'" width="120" height="120">','<div class="inner">','<div class="caption">',""+t.title,"</div>",'<div class="st">','<span class="time">'+t.datetime+"</span>",'<span class="tag">'+t.tag+"</span>","</div>",'<div class="price">',"<span>"+t.price+"</span>","</div>","</div>","</div></a>"].join("")},addBuyToday:function(t,e){for(var i=t.find(".buytoday"),s=0;s<i.length;s++)i.eq(s).append(e.find(".buytoday:first")),this.lmhour(i.eq(s).find(".buytoday"))},lmhour:function(t){var e=this,i=t.attr("data-iskillonline"),s=null;"undefined"!=typeof i&&(_pollingLm=function(t){var i=t.attr("data-id"),o=t.find(".btn"),n=t.find(".disabled");$.getJSON(e.ajaxUrls.lmhour,{id:i,timer:Date.now()}).done(function(e){0===e.error_code&&(1==e.data.onsale?(o.show(),n.hide(),s=setTimeout(function(){_pollingLm(t)},6e4)):(o.hide(),n.text("已抢光").show(),clearTimeout(s)))})},1==i&&(s=setTimeout(function(){_pollingLm(t)},6e4)))},bindEvent:function(){new t({box:".slider-lastminute",gradualShowClass:"gradually_col3_show"}),$("img.lazy:visible",this.$lastminuteBox).lazyload({effect:"fadeIn"})}},e}),define("common/js/home/LastminuteFactory",["common/js/home/Lastminute","common/js/home/Lastminute_b"],function(t,e){return"b"===$(".buytoday-container").attr("data-test")?e:t}),define("common/js/home/Hottravels",["common/js/common/Slider"],function(t){"use strict";function e(t){this.opts=$.extend({box:"#Hottravels"},t),this.ajaxUrls={hottravels:"qcross/home/ajax?action=thread"},this.$hottravelsBox=$(t.box),this.sliderLen=0,this.init()}return e.prototype={init:function(){this.loadHottravels()},loadHottravels:function(){var t=this,e={timer:+new Date};$.getJSON(this.ajaxUrls.hottravels,e).done(function(e){0===e.error_code&&t.renderHottravels(e.data)})},renderHottravels:function(t){var e=[],i=[];e.push('<div class="slider slider-hottravels">'),i.push('<div class="slider-control">'),e.push('<div class="slider-inner">');for(var s=0,o=t.length;s<o;s++){e.push('<div class="item" style="'+(0===s?"display: block;":"")+'">'),e.push("<ul>");for(var n=0,a=t[s].length;n<a;n++){var r=t[s][n];e.push("<li>"),e.push('<div class="travel" title="'+r.subject+'">'),e.push('<div class="photo">'),e.push('<a data-bn-ipg="index-hotThread-pic-'+s+n+'" href="'+r.url+'" target="_blank" data-ra_arg="'+r.ra_arg+'"><img class="lazy" src="images/grey.gif" data-original="'+r.pic+'" width="275" height="185"></a>'),
e.push('<div class="like total_replies">'+r.total_replies+"</div>"),e.push("</div>"),e.push('<div class="inner">'),e.push('<div class="info">'),e.push('<span class="avatar">'),e.push('<a data-bn-ipg="index-hotThread-writerPic-'+s+n+'" href="'+r.auth.user_url+'" target="_blank"><img class="lazy" src="images/grey.gif" data-original="'+r.auth.avatar+'"></a>'),e.push("</span>"),e.push('<span class="txt">'),e.push('<a data-bn-ipg="index-hotThread-name-'+s+n+'" href="'+r.auth.user_url+'" target="_blank">'+r.username+"</a>"),r.auth&&""!==r.auth.auth_type&&(e.push('<span class="auth_avatar_q s"> '),"member"==r.auth.auth_type?e.push('<i onclick="window.location=\'//www.qyer.com/u/member/xuan\';" class="icon member" data-toggle="tooltip" data-placement="top" data-original-title="'+r.auth.attestation+'"></i>'):"company"==r.auth.auth_type?e.push('<i onclick="window.location=\'//www.qyer.com/u/company/xuan\';" class="icon company" data-toggle="tooltip" data-placement="top" data-original-title="'+r.auth.attestation+'"></i>'):"qyer"==r.auth.auth_type&&e.push('<i class="icon qyer" data-toggle="tooltip" data-placement="top" data-original-title="'+r.auth.attestation+'"></i>'),e.push("</span>")),e.push("</span>"),e.push("</div>"),e.push('<a data-bn-ipg="index-hotThread-title-'+s+n+'" href="'+r.url+'" target="_blank" data-ra_arg="'+r.ra_arg+'">'),e.push('<div class="caption">'),e.push(r.subject),e.push("</div>"),e.push("</a>"),e.push("</div>"),"digest"==r.label?e.push('<em class="tip">精华</em>'):"heated_discuss"==r.label&&e.push('<em class="tip hot">热议</em>'),e.push("</div>"),e.push("</li>")}e.push("</ul>"),e.push("</div>"),i.push("<a"+(0===s?' class="current"':"")+' data-bn-ipg="index-hotThread-page" href="javascript:;"></a>')}e.push("</div>"),i.push("</div>"),e.push(i.join("")),e.push("</div>"),e.push('<div class="more">'),e.push('<a href="//bbs.qyer.com" data-bn-ipg="index-hotThread-more" target="_blank">查看更多游记</a>'),e.push("</div>"),this.$hottravelsBox.html(e.join("")),this.bindEvent()},bindEvent:function(){new t({box:".slider-hottravels",gradualShowClass:"gradually_col4_show"}),$("img.lazy:visible",this.$HottravelsBox).lazyload({effect:"fadeIn"}),$('[data-toggle="tooltip"]',this.$HottravelsBox).tooltip({container:"body"})}},e}),define("common/js/home/Usercard",[],function(){function t(t){this.opts=$.extend({box:"#usercard"},t),this.ajaxUrls={usercard:"qcross/home/ajax?action=persons",follow:"qcross/user/ajax.php"},this.$usercardBox=$(t.box),this.$cardcont=this.$usercardBox.find(".cardcont"),this.ajaxLoad=!1,this.sliderLen=0,this.init()}return t.prototype={init:function(){this.$usercardBox.length&&this.loadUser()},loadUser:function(){var t=this,e={timer:(new Date).getTime()};return!this.ajaxLoad&&(this.ajaxLoad=!0,void $.getJSON(this.ajaxUrls.usercard,e,function(e){t.ajaxLoad=!1,0==e.error_code&&t.renderUsercard(e.data)}))},renderUsercard:function(t){var e=[];if(t.length)for(var i=0;i<t.length;i++){e.push("<ul"+(0==i?' class="gradually_col2_show show"':"")+">");for(var s=0;s<t[i].length;s++){var o=t[i][s];e.push("<li>"),e.push('<div class="item">'),e.push('<div class="avatar">'),e.push('<a data-bn-ipg="index-discover-pic-'+i+s+'" href="'+o.url+'" target="_blank"><img class="lazy" src="images/grey.gif" data-original="'+o.avatar+'" width="60" height="60"></a>'),o.auth&&(e.push('<span class="auth_avatar_q posa m">'),e.push("<i"+(o.auth.url?" onclick=\"window.location='"+o.auth.url+"';\"":"")+' class="icon '+o.auth.type+'" title="'+o.auth.text+'"></i>'),e.push("</span>")),e.push("</div>"),e.push('<div class="inner">'),e.push('<a class="ui_attent_btn follow _js_follow_func" href="javascript:void(0);" data-bn-ipg="index-discover-follow-'+i+s+'" data-uid="'+o.uid+'" data-relate="1" data-each="'+(o.each?o.each:"0")+'">关注</a>'),e.push('<p class="name">'),e.push('<a data-bn-ipg="index-discover-name-'+i+s+'" href="'+o.url+'" target="_blank">'+o.username+"</a>"),e.push("</p>"),e.push('<p class="fans"><em>'+o.fans+"</em>粉丝</p>"),e.push('<p class="auth"><span>'+(o.auth?o.auth.text:"")+"</span></p>"),e.push("</div>"),e.push("</div>"),e.push("</li>")}e.push("</ul>")}else e=['<div class="userEmpty">您已关注了所有最新认证用户</div>'];t.length>1&&this.$usercardBox.find(".change").show(),this.$cardcont.html(e.join("")),this.bindEvent()},bindEvent:function(){var t=this;this.$usercardBox.on("click",".change",function(){t.changeUserCard()}),this.$usercardBox.on("click","._js_follow_func",function(){qyerUtil.isLogin()?t.follow($(this)):qyerUtil.doLogin()}),$("img.lazy:visible",this.$usercardBox).lazyload({effect:"fadeIn"})},changeUserCard:function(){var t=this.$usercardBox.find(".show"),e=t.next().length?t.next():this.$usercardBox.find("ul:first");t.removeClass("show gradually_col2_show"),e.addClass("show gradually_col2_show").find("img.lazy").lazyload({effect:"fadeIn"})},ajaxLoading:function(){return'<div class="sk-wave"><div class="sk-rect sk-rect1"></div> <div class="sk-rect sk-rect2"></div> <div class="sk-rect sk-rect3"></div> <div class="sk-rect sk-rect4"></div> <div class="sk-rect sk-rect5"></div></div>'},follow:function(t){function e(t,e,i){i.attr("data-relate",e),"1"==t?i.hasClass("ui_attent_btn_each")?(i.removeClass("ui_attent_btn_each"),i.hasClass("_js_index_switch_do")&&jQuery("._js_index_switch_do").removeClass("ui_attent_btn_each")):(i.addClass("ui_attent_btn_each"),i.hasClass("_js_index_switch_do")&&jQuery("._js_index_switch_do").addClass("ui_attent_btn_each")):i.hasClass("ui_attent_btn_yes")?(i.removeClass("ui_attent_btn_yes"),i.hasClass("_js_index_switch_do")&&jQuery("._js_index_switch_do").removeClass("ui_attent_btn_yes")):(i.addClass("ui_attent_btn_yes"),i.hasClass("_js_index_switch_do")&&jQuery("._js_index_switch_do").addClass("ui_attent_btn_yes"))}var i=t.attr("data-uid"),s=t.attr("data-relate"),o=t.attr("data-each"),n="";n=1==s?"action=addfriend&fuid="+i:"action=channelfriend&uid="+i;var a=this.ajaxUrls.follow;jQuery.ajax({type:"POST",url:a,data:n,dataType:"json",beforeSend:function(t){},success:function(i){"ok"==i.result?(s=0==s?1:0,e(o,s,t)):e(o,s,t)}})}},t}),function(t,e){"function"==typeof define&&define.amd?define("common/js/common/Scroll",e):"object"==typeof exports?module.exports=e():t.Scroll=e()}(this,function(){function t(t){this.opts=$.extend({box:".scroll",speeds:5e3,direction:"vertical"},t),this.$scrollBox=$(this.opts.box),this.$ul=this.$scrollBox.find("ul"),this.style="vertical"===this.opts.direction?"top":"left",this.size="vertical"===this.opts.direction?this.$ul.find("li").height():this.$ul.find("li").width(),this.timer=null,this.init()}return t.prototype={init:function(){this.$ul.css({position:"relative"}),this.autoScroll(),this.bindEvent(),this.imglazy(this.$ul.find("li:eq(0) .imglazy")[0]),this.imglazy(this.$ul.find("li:eq(1) .imglazy")[0])},scroll:function(){var t=this,e=this.$ul.find("li:first"),i={};i[this.style]=-(t.size+20),e.addClass("animationHide"),this.imglazy(this.$ul.find("li:eq(2) .imglazy")[0]),t.$ul.animate(i,500,function(){t.$ul.css(t.style,0),e.removeClass("animationHide").appendTo(t.$ul)})},autoScroll:function(){var t=this;clearInterval(this.timer),this.timer=setInterval(function(){t.scroll()},this.opts.speeds)},stopScroll:function(){clearInterval(this.timer)},bindEvent:function(){var t=this;this.$scrollBox.on("mouseenter",function(){t.stopScroll()}).on("mouseleave",function(){t.autoScroll()})},imglazy:function(t){t&&t.src.indexOf("grey.gif")!=-1&&(t.src=t.getAttribute("data-original"))}},t}),define("common/js/home/Advtry",["common/js/common/Scroll"],function(t){function e(t){this.opts=$.extend({box:"#advtry"},t),this.$advtryBox=$(t.box),this.$advtryBox.length&&this.init()}return e.prototype={init:function(){this.rTime(),this.userScroll()},userScroll:function(){new t({box:".user-scroll",direction:"horizontal"})},rTime:function(){var t=this.$advtryBox.find(".rtime"),e=null,i=function(){var i=o(t.attr("data-end-time"));t.html(i.rtime),i.rtimeEnd||clearInterval(e)},o=function(t){var e=new Date(parseInt(t)),i=new Date,o=e.getTime()-i.getTime(),n=h=m=s=0,a=!0;return o>=0?(n=Math.floor(o/1e3/60/60/24),h=Math.floor(o/1e3/60/60%24),m=Math.floor(o/1e3/60%60),s=Math.floor(o/1e3%60)):a=!1,{rtime:n+"天"+h+"小时"+m+"分"+s+"秒",rtimeEnd:a}};e=setInterval(i,1e3)}},e}),define("common/js/home/SpecialPlanning",[],function(){function t(t){this.opts=$.extend({box:"#specialPlanning",currentClass:"active",currentIndex:0},t),$.extend(this,this.opts||{}),this.$box=$(this.box),this.timer=null,this.$box.length&&this.init()}return t.prototype={init:function(){this.$tabs=this.$box.find(".planning-tabs > li"),this.$items=this.$box.find(".planning-item").hide(),this.$tabs.eq(this.currentIndex).addClass(this.currentClass),this.$items.eq(this.currentIndex).show(),this.bindSlider()},bindSlider:function(){var t=this;this.$tabs.on("mouseenter",function(){var e=$(this).index();return t.currentIndex!=e&&(t.currentIndex=e,void t._toItem(t.currentIndex))}),this.$box.on("mouseenter",function(){t.stopPlay()}).on("mouseleave",function(){t.autoPlay()}),this.autoPlay()},_toItem:function(t){this.$tabs.removeClass(this.currentClass).eq(t).addClass(this.currentClass),this.$items.hide().eq(t).fadeIn()},_nextToItem:function(){this.currentIndex++,this.currentIndex>=this.$tabs.length&&(this.currentIndex=0),this._toItem(this.currentIndex)},autoPlay:function(){var t=this;clearInterval(this.timer),this.timer=setInterval(function(){t._nextToItem()},5e3)},stopPlay:function(){clearInterval(this.timer)}},t}),define("common/models/basic/js/require-css!web_old_tooltips",[],function(){}),!function(t){define("web_old_tooltips",["css!web_old_tooltips"],t(jQuery))}(function(t){"use strict";function e(e){return this.each(function(){var s=t(this),o=s.data("bs.tooltip"),n="object"==typeof e&&e;(o||!/destroy|hide/.test(e))&&(o||s.data("bs.tooltip",o=new i(this,n)),"string"==typeof e&&o[e]())})}var i=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.init("tooltip",t,e)};i.VERSION="3.3.4",i.TRANSITION_DURATION=150,i.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},i.prototype.init=function(e,i,s){if(this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(s),this.$viewport=this.options.viewport&&t(this.options.viewport.selector||this.options.viewport),this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var o=this.options.trigger.split(" "),n=o.length;n--;){var a=o[n];if("click"==a)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=a){var r="hover"==a?"mouseenter":"focusin",l="hover"==a?"mouseleave":"focusout";this.$element.on(r+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},i.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,function(t,s){i[t]!=s&&(e[t]=s)}),e},i.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i&&i.$tip&&i.$tip.is(":visible")?void(i.hoverState="in"):(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show())},i.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide()},i.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var s=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!s)return;var o=this,n=this.tip(),a=this.getUID(this.type);this.setContent(),n.attr("id",a),this.$element.attr("aria-describedby",a),this.options.animation&&n.addClass("fade");var r="function"==typeof this.options.placement?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,l=/\s?auto?\s?/i,h=l.test(r);h&&(r=r.replace(l,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass(r).data("bs."+this.type,this),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var c=this.getPosition(),u=n[0].offsetWidth,d=n[0].offsetHeight;if(h){var p=r,m=this.options.container?t(this.options.container):this.$element.parent(),f=this.getPosition(m);r="bottom"==r&&c.bottom+d>f.bottom?"top":"top"==r&&c.top-d<f.top?"bottom":"right"==r&&c.right+u>f.width?"left":"left"==r&&c.left-u<f.left?"right":r,n.removeClass(p).addClass(r)}var g=this.getCalculatedOffset(r,c,u,d);this.applyPlacement(g,r);var v=function(){var t=o.hoverState;o.$element.trigger("shown.bs."+o.type),o.hoverState=null,"out"==t&&o.leave(o)};t.support.transition&&this.$tip.hasClass("fade")?n.one("bsTransitionEnd",v).emulateTransitionEnd(i.TRANSITION_DURATION):v()}},i.prototype.applyPlacement=function(e,i){var s=this.tip(),o=s[0].offsetWidth,n=s[0].offsetHeight,a=parseInt(s.css("margin-top"),10),r=parseInt(s.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(r)&&(r=0),e.top=e.top+a,e.left=e.left+r,t.offset.setOffset(s[0],t.extend({using:function(t){s.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),s.addClass("in");var l=s[0].offsetWidth,h=s[0].offsetHeight;"top"==i&&h!=n&&(e.top=e.top+n-h);var c=this.getViewportAdjustedDelta(i,e,l,h);c.left?e.left+=c.left:e.top+=c.top;var u=/top|bottom/.test(i),d=u?2*c.left-o+l:2*c.top-n+h,p=u?"offsetWidth":"offsetHeight";s.offset(e),this.replaceArrow(d,s[0][p],u)},i.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},i.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},i.prototype.hide=function(e){function s(){"in"!=o.hoverState&&n.detach(),o.$element.removeAttr("aria-describedby").trigger("hidden.bs."+o.type),e&&e()}var o=this,n=t(this.$tip),a=t.Event("hide.bs."+this.type);return this.$element.trigger(a),a.isDefaultPrevented()?void 0:(n.removeClass("in"),t.support.transition&&n.hasClass("fade")?n.one("bsTransitionEnd",s).emulateTransitionEnd(i.TRANSITION_DURATION):s(),this.hoverState=null,this)},i.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},i.prototype.hasContent=function(){return this.getTitle()},i.prototype.getPosition=function(e){e=e||this.$element;var i=e[0],s="BODY"==i.tagName,o=i.getBoundingClientRect();null==o.width&&(o=t.extend({},o,{width:o.right-o.left,height:o.bottom-o.top}));var n=s?{top:0,left:0}:e.offset(),a={scroll:s?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},r=s?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},o,a,r,n)},i.prototype.getCalculatedOffset=function(t,e,i,s){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-s,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-s/2,left:e.left-i}:{top:e.top+e.height/2-s/2,left:e.left+e.width}},i.prototype.getViewportAdjustedDelta=function(t,e,i,s){var o={top:0,left:0};if(!this.$viewport)return o;var n=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(t)){var r=e.top-n-a.scroll,l=e.top+n-a.scroll+s;r<a.top?o.top=a.top-r:l>a.top+a.height&&(o.top=a.top+a.height-l)}else{var h=e.left-n,c=e.left+n+i;h<a.left?o.left=a.left-h:c>a.width&&(o.left=a.left+a.width-c)}return o},i.prototype.getTitle=function(){var t,e=this.$element,i=this.options;return t=e.attr("data-original-title")||("function"==typeof i.title?i.title.call(e[0]):i.title)},i.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},i.prototype.tip=function(){return this.$tip=this.$tip||t(this.options.template)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},i.prototype.enable=function(){this.enabled=!0},i.prototype.disable=function(){this.enabled=!1},i.prototype.toggleEnabled=function(){this.enabled=!this.enabled},i.prototype.toggle=function(e){var i=this;e&&(i=t(e.currentTarget).data("bs."+this.type),i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i))),i.tip().hasClass("in")?i.leave(i):i.enter(i)},i.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type)})};var s=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=i,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=s,this}}),window.qyerUtil.insertStyle([".qui-feedback { position:fixed; _position:absolute; z-index:99; top:120px; right:-246px; display:none;}",".qui-feedback .icon { float:left; width:24px; height:150px; background:url(//static.qyer.com/models/common/component/feedback/icons_feedback.png) 0 0 no-repeat; cursor:pointer;}",".qui-feedback.js-current > .icon { background-position:-29px 0;}",".qui-feedback .cnt { float:left; width:246px; height:280px; background-color:#e8e4df;}",".qui-feedback .cnt form { padding:10px; font-size:0;}",".qui-feedback .cnt textarea { width:214px; height:192px; padding:2px 5px; border:1px solid #ccc; font-size:12px;}",".qui-feedback .cnt input { float:right; margin-top:10px;}",".qui-feedback .help { position:relative; top:-1px; border:1px solid #ccc; border-top:none; background:#fefdc9; height:24px; line-height:22px; text-align:center;font-size:12px;}",".qui-feedback .help a { font-weight:bold; }"].join("")),setTimeout(function(){!function(){function t(){this.init()}var e;t.prototype={$div:null,init:function(){this.createDom(),this.bindEvt()},tip:function(t){requirejs(["web_old_tip"],function(e){e.tip(t)})},createDom:function(){var t=['<div class="qui-feedback" style="display:none;">','<div class="icon js-btn" title="意见反馈"></div>','<div class="cnt">','<form method="post">','<textarea class="js-feedback-cnt" cols="50" rows="10" placeholder="有任何意见或建议请告诉我们"></textarea>','<p class="help">使用遇到问题？请先进入<a href="//bbs.qyer.com/forum-10-1.html" target="_blank">帮助中心</a></p>','<input class="ui_button js-submitBtn" type="button" value="提交" class="ui_button">',"</form>","</div>","</div>"].join("");$(document.body).append(t),this.$div=$(".qui-feedback"),$(window).scrollTop()>=400&&this.$div.fadeIn(300),$div=null},showLogin:function(){qyerUtil.doLogin()},bindEvt:function(){var t=this;this.$div.on("click",".js-btn",function(e){t[t.$div.hasClass("js-current")?"hideDiv":"showDiv"]()}).on("click","textarea.js-feedback-cnt",function(t){window.QYER&&window.QYER.uid||e.showLogin()}).on("click","input.js-submitBtn",function(i){if(window.QYER&&window.QYER.uid){var s=t.checkForm();s&&t.submitForm(s)}else e.showLogin()}),$(document).on("click",function(e){var i=$(e.target);i.closest(".qui-feedback").size()<1&&t.hideDiv()}),$(window).on("scroll",function(){var e=$(this).scrollTop();e>=400?t.$div.fadeIn(300):t.$div.fadeOut(300)})},showDiv:function(){var t=this;this.$div.animate({right:0},200,function(){t.$div.addClass("js-current")})},hideDiv:function(){var t=this;this.$div.animate({right:-246},200,function(){t.$div.removeClass("js-current")})},checkValue:{cnt:function(t){var i=$(".js-feedback-cnt").val();if(i=$.trim(i),""==i||"有任何意见或建议请告诉我们"==i)return e.tip({text:"意见或建议不能为空",type:"error"}),!1;var s=window.qyerUtil.getWordLen(i);return s<20?(e.tip({text:"不能少于10个字",type:"error"}),!1):i}},checkForm:function(){var t=this.$div.find(".js-feedback-cnt").val();return this.checkValue.cnt(t)},submitForm:function(t){var i=this,s={data:{cnt:t,url:location.href},onSuccess:function(t){i.$div.find("textarea.js-feedback-cnt").val(""),e.tip({text:t.data.msg})},onError:function(t){77==t.error_code?e.showLogin():e.tip({text:ret.data.msg,type:"error"})}};this.postFeedback(s)},postFeedback:function(t){t.posturl="qcross/place/api.php?action=feedback",window.qyerUtil.doAjax(t)}},e=new t}()},3e3),define("common/models/common/component/feedback/feedback",function(){}),$(function(){"use strict";function t(){$(".header")[($(window).width()<1280?"add":"remove")+"Class"]("media_header_1280")}var e=[{id:"interest"},{id:"lastminute"},{id:"hottravels"},{id:"usercard"},{id:"advtry"},{id:"specialPlanning"}];(navigator.userAgent.indexOf("MSIE7.0")>0||navigator.userAgent.indexOf("MSIE 8.0")>0)&&(t(),$(window).on("resize",t)),window.__userStatusCallBack=function(t){t.uid>0?$(".link-comment").attr("href","//www.qyer.com/u/"+t.uid+"/footprint?showcomm=1"):(requirejs(["common/models/common/component/footerBanner/footerBanner"],function(t){t.show()}),jQuery(document).on("click","._jsweibologin",function(){var t=jQuery(this).attr("url");t||(t=window.location.href);var e="//login.qyer.com/auth.php?action=weibo&popup=1&refer="+t;window.location=e}),jQuery(document).on("click","._jsqqlogin",function(){var t=jQuery(this).attr("url");t||(t=window.location.href);var e="//login.qyer.com/auth.php?action=qq&popup=1&refer="+t;window.location=e}))},NProgress.start(),$(window).load(function(){NProgress.done()}),requirejs(["common/js/common/Carousel"],function(t){new t({box:"#qyer_banner",carousel:"#carousel",bannerbg:"#bannerbg",onSlide:function(t){$(".placesearch_txt").attr("placeholder",$(t).find(".h_text").val()),""===$.trim($(".placesearch_txt").val())&&$(".place_search_form").attr("action",$(t).find(".h_url").val())}})}),requirejs(["common/js/common/Slider"],function(t){new t({box:".slider-hottravels"})}),requirejs(["common/js/home/PlaceSearch","common/js/home/ZSearch","common/js/home/HotelSearch"],function(t,e,i){new t,new e,new i}),requirejs(["common/js/home/Interest","common/js/home/LastminuteFactory","common/js/home/Hottravels","common/js/home/Usercard","common/js/home/Advtry","common/js/home/SpecialPlanning"],function(t,i,s,o,n,a){function r(e){switch(e){case"interest":new t({box:"#interest"});break;case"lastminute":new i({box:"#lastminute"});break;case"hottravels":new s({box:"#hottravels"});break;case"usercard":new o({box:"#usercard"});break;case"advtry":new n({box:"#advtry"});break;case"specialPlanning":new a({box:"#specialPlanning"})}}for(var l=0;l<e.length;l++)r(e[l].id)}),$("#search").on("click",".tab a",function(){var t=this.getAttribute("data-type");$("#search")[0].className="search active-"+t,/place|z|hotel/.test(t)&&$("#search ."+t+"search_txt")[0].select()});for(var i=0;i<e.length;i++)document.getElementById(e[i].id)&&(e[i].index=i,e[i].offsetTop=document.getElementById(e[i].id).offsetTop);"undefined"!=typeof document.createElement("div").style.transform&&$(window).bind("scroll",function(){var t=Math.max(document.documentElement.scrollTop,document.body.scrollTop),e=t/8<80?t/8:80;$("#search").css({transform:"translateY("+Math.floor(e/1.8)+"px)"}),$(".carousel-inner").css({transform:"translateY("+Math.floor(e)+"px)"}).find(".text-panel").css({transform:"translateY("+Math.floor(-e)+"px)"})}),$(".link-comment").click(function(){if(!qyerUtil.isLogin())return qyerUtil.doLogin(),!1}),requirejs(["web_old_tooltips"],function(){$('[data-toggle="tooltip"]').tooltip({container:"body"})}),$("img.lazy").lazyload({effect:"fadeIn"}),requirejs(["common/models/common/component/feedback/feedback"])}),window.scrollTo(0,0),window.getCookie=qyerUtil.getCookie,define("common/js/home/index",function(){}),function(t){var e=document,i="appendChild",s="styleSheet",o=e.createElement("style");o.type="text/css",e.getElementsByTagName("head")[0][i](o),o[s]?o[s].cssText=t:o[i](e.createTextNode(t))}(".qui-tip{position:fixed;top:75pt;left:0;width:100%;text-align:center;display:none;z-index:1100}.qui-tip-box{display:inline-block;min-width:90pt;max-width:390px;padding:20px 30px;background-color:#fff;box-shadow:0 2px 7px rgba(0,0,0,.25);border:1px solid silver;text-align: left;font-size:18px;line-height:2pc}.qui-tip-text{display:block;position:relative;padding-left:34px}.qui-tip-text:before{content:'';position:absolute;left:0;top:4px;width:24px;height:24px;background:url(//fed.qyerstatic.com/core/web/common/resource/ui/oldtip/icons2.png) no-repeat #fff}.qui-tip-box-error .qui-tip-text:before{background-position:0 -5pc}.qui-tip-box-warning .qui-tip-text:before{background-position:0 -40px}.tooltip{position:absolute;z-index:1070;display:block;font-family:\"Helvetica Neue\",Helvetica,Arial,sans-serif;font-size:9pt;font-weight:400;line-height:1.4;filter:alpha(opacity=0);opacity:0}.tooltip:after{content:''}.tooltip.in{filter:alpha(opacity=90);opacity:.9}.tooltip.top{padding:5px 0;margin-top:-3px}.tooltip.right{padding:0 5px;margin-left:3px}.tooltip.bottom{padding:5px 0;margin-top:3px}.tooltip.left{padding:0 5px;margin-left:-3px}.tooltip-inner{max-width:200px;padding:3px 8px;color:#959595;text-align:center;text-decoration:none;background-color:#f5f5f5;border:1px solid #d7d7d7;border-radius:4px}.tooltip-arrow,.tooltip:after{position:absolute;width:0;height:0;border-color:transparent;border-style:solid}.tooltip.top .tooltip-arrow,.tooltip.top:after{bottom:0;left:50%;margin-left:-5px;border-width:5px 5px 0;border-top-color:#D7D7D7}.tooltip.top:after{bottom:1px;border-top-color:#f5f5f5}.tooltip.top-left .tooltip-arrow,.tooltip.top-left:after{right:5px;bottom:0;margin-bottom:-5px;border-width:5px 5px 0;border-top-color:#D7D7D7}.tooltip.top-left:after{bottom:1px;border-top-color:#f5f5f5}.tooltip.top-right .tooltip-arrow,.tooltip.top-right:after{bottom:0;left:5px;margin-bottom:-5px;border-width:5px 5px 0;border-top-color:#D7D7D7}.tooltip.top-right:after{bottom:1px;border-top-color:#f5f5f5}.tooltip.right .tooltip-arrow,.tooltip.right:after{top:50%;left:0;margin-top:-5px;border-width:5px 5px 5px 0;border-right-color:#D7D7D7}.tooltip.right:after{left:1px;border-right-color:#f5f5f5}.tooltip.left .tooltip-arrow,.tooltip.left:after{top:50%;right:0;margin-top:-5px;border-width:5px 0 5px 5px;border-left-color:#D7D7D7}.tooltip.left:after{right:1px;border-left-color:#f5f5f5}.tooltip.bottom .tooltip-arrow,.tooltip.bottom:after{top:0;left:50%;margin-left:-5px;border-width:0 5px 5px;border-bottom-color:#D7D7D7}.tooltip.bottom:after{top:1px;border-bottom-color:#f5f5f5}.tooltip.bottom-left .tooltip-arrow,.tooltip.bottom-left:after{top:0;right:5px;margin-top:-5px;border-width:0 5px 5px;border-bottom-color:#D7D7D7}.tooltip.bottom-left:after{top:1px;border-bottom-color:#f5f5f5}.tooltip.bottom-right .tooltip-arrow,.tooltip.bottom-right:after{top:0;left:5px;margin-top:-5px;border-width:0 5px 5px;border-bottom-color:#D7D7D7}.tooltip.bottom-right:after{top:1px;border-bottom-color:#f5f5f5}.fade{opacity:0;-webkit-transition:opacity .15s linear;-o-transition:opacity .15s linear;transition:opacity .15s linear}.fade.in{opacity:1}"),function(t,e){function s(){var e=t.cookie.match(/guid=([^;]+);/);return e&&e.length&&e[1]?e[1]:""}var o=!(/Android|iPhone|SymbianOS|Windows Phone/gi.test(navigator.userAgent)&&/^(https?:)?\/\/m\.qyer\.com\/?.*$/.test(window.location.href)),n={ad_request:"//hades.qyer.com/ad/show",current_url:encodeURIComponent(t.location.href),guid:s(),callback:"adHandler",limit:1,timeout:100,context:"ad",v:"1.2",start:function(){for(var t=n.getClassNames("ad_zone","div"),e=0;e<t.length;e++){var i=t[e];n.sendjsonp(n.createRquest(i))}},createRquest:function(t){var e=t.getAttribute("data-countries"),i=t.getAttribute("data-areas"),s=n.ad_request,o=t.id.replace(/zoneid-/,"");return s+="?",s+="zone_id="+o,s+="&context="+n.context,e&&(s+="&countries="+e),i&&(s+="&areas="+i),"object"==typeof QYER&&QYER&&QYER.uid&&(s+="&uid="+QYER.uid),s+="&current_url="+n.current_url,s+="&guid="+n.guid,s+="&callback="+n.callback,s+="&limit="+n.limit},sendjsonp:function(e){var i=t.createElement("script");i.setAttribute("src",e),t.getElementsByTagName("head")[0].appendChild(i)},adHandler:function(e){if(e&&0===e.status){var i=e.data.content,s=i.zone_id,a=t.getElementById("zoneid-"+s);if(i.ad_list.length){var r=i.ad_list[0];a.style.height=r.height+"px",a.style.width=r.width+"px",o||(a.style.width="100%",a.style.height=window.screen.width/r.width*r.height+"px");var l=n.createFrame({width:a.clientWidth,height:a.clientHeight});a.appendChild(l),n.loadFrame(l,n.createContent(r)),a.className+=" loaded",l.style.display="block",window.jQuery?"none"==a.style.display&&jQuery(a).slideDown():"block"==a.style.display,$(window).trigger("AD_LOADED",[e])}else n.hideFrame(a),a.className+=" loaded nocontent"}},createContent:function(t){function e(e,i){return e+="?clickTAG="+encodeURIComponent(t.target_url),['<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,19,0" width="100%" height="100%" title="flash">','<param name="movie" value="'+e+'" />','<param name="quality" value="high" />','<param name="IsAutoPlay" value="1" />','<param name="PLAY" value="true">','<param name="wmode" value="transparent">','<embed id="swfControl" src="'+e+'" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" width="100%" height="100%" wmode="transparent" autostart="true" play="true"></embed>',"</object>"].join("")}var i="";if(t){switch(i+='<a href="'+t.target_url+'" target="_blank" style="position:relative;width:100%;height:100%;display:block;">',t.content_type.toLowerCase()){case"img":i+='<img src="'+t.content_url+'" alt="'+t.alt+'" title="" border="" style="display:block;width:100%;height:100%;" />';break;case"flash":i+=e(t.content_url,t.target_url)}"ST_AD"==t.content_type_op&&(i+='<img src="images/ad_icon_3x.png" style="width:44px !important;height:15px !important;position:absolute !important;left:0px !important;bottom:0px !important;" />'),i+="</a>"}return i},hideFrame:function(t){t.style.display="none"},createFrame:function(e){var i=t.createElement("IFRAME"),s=i.style;return i.scrolling="no",i.frameBorder=0,i.width="100%",i.height="100%",s.border=0,s.overflow="hidden",i},loadFrame:function(t,e){var i=t.contentDocument||t.contentWindow.document;i.open(),i.writeln('<!DOCTYPE html><html style="width:100%;height:100%;"><head><base target="_top"></head><body border="0" margin="0" style="margin: 0;padding:0;width:100%;height:100%;">'),i.writeln(e),i.writeln("</body></html>"),i.close()},getClassNames:function(e,s){function o(t,e){for(var i=t.className.split(/\s+/),s=0;s<i.length;s++)if(i[s]==e)return!0;return!1}if(t.getElementsByClassName)return t.getElementsByClassName(e);var n=t.getElementsByTagName(s),a=[];for(i=0;i<n.length;i++)o(n[i],e)&&a.push(n[i]);return a}};window.adHandler=n.adHandler,n.start()}(document,window);